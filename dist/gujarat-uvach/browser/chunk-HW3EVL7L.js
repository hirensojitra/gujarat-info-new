import{a as re}from"./chunk-F54JW7TG.js";import{a as oe}from"./chunk-OGYA6K2F.js";import{e as ee,f as te,g as ie,h as le,p as ne}from"./chunk-W4G6GZ5A.js";import{a as ae}from"./chunk-F7S2VGP6.js";import"./chunk-X6E4KI7S.js";import{c as B,d as f,f as R,g as H,k as P,o as J,r as z,s as K,t as Q,u as W,w as X,x as Y,y as Z}from"./chunk-2V5UGUD5.js";import"./chunk-QHXDM6TZ.js";import{Aa as v,Ba as p,F,G as S,I as T,Ia as o,Ja as c,Ka as j,L as N,La as O,M as k,Mb as I,R as b,S as V,Va as y,Wa as D,X as L,ba as r,ca as h,gb as A,hb as U,ma as g,mb as $,oa as d,ob as q,ua as l,ub as G,va as i,wa as u,za as E}from"./chunk-6PSXH6NM.js";var de=(()=>{class t{constructor(e){this.http=e,this.apiUrl="http://localhost:1111/api/members"}getMembersByVillage(e){let a=`${this.apiUrl}/${e}`;return this.http.get(a)}isMemberExistsByVillage(e){let a=`${this.apiUrl}/exists/${e}`;return this.http.get(a)}static{this.\u0275fac=function(a){return new(a||t)(T(G))}}static{this.\u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ue(t,s){if(t&1&&(l(0,"option",43),o(1),i()),t&2){let e=s.$implicit;d("value",e.id),r(),c(e.name)}}function ve(t,s){if(t&1&&(l(0,"div",36)(1,"div",37)(2,"label",38),o(3,"District"),i()(),l(4,"div",39)(5,"select",40)(6,"option",41),o(7,"Select a district"),i(),g(8,ue,2,2,"option",42),i()()()),t&2){let e=p();r(5),d("options",e.districts),r(3),d("ngForOf",e.districts)}}function fe(t,s){if(t&1&&(l(0,"option",43),o(1),i()),t&2){let e=s.$implicit;d("value",e.id),r(),c(e.name)}}function he(t,s){if(t&1&&(l(0,"div",36)(1,"div",37)(2,"label",44),o(3,"Taluka"),i()(),l(4,"div",39)(5,"select",45)(6,"option",41),o(7,"Select a taluka"),i(),g(8,fe,2,2,"option",42),i()()()),t&2){let e=p();r(5),d("options",e.talukas),r(3),d("ngForOf",e.talukas)}}function _e(t,s){if(t&1){let e=E();l(0,"button",46),v("click",function(){b(e);let n=p();return V(n.openDeletedModal())}),u(1,"i",47),o(2,"Restore"),i()}}function be(t,s){if(t&1){let e=E();l(0,"tr",48)(1,"td"),o(2),i(),l(3,"td"),o(4),i(),l(5,"td"),o(6),i(),l(7,"td"),o(8),i(),l(9,"td",49)(10,"button",50),v("click",function(){let n=b(e).$implicit,m=p();return V(m.editVillage(n))}),u(11,"i",51),i(),l(12,"button",52),v("click",function(){let n=b(e).$implicit,m=p();return V(m.deleteVillage(n.id))}),u(13,"i",53),i()()()}if(t&2){let e=s.$implicit,a=s.index;r(2),c(a+1),r(2),c(e.id),r(2),c(e.name),r(2),c(e.gu_name)}}function Ve(t,s){if(t&1&&(l(0,"div",54)(1,"div",37)(2,"label",55),o(3,"Village ID"),i()(),l(4,"div",39)(5,"div",56),o(6),u(7,"input",57),i()()()),t&2){let e,a=p();r(6),j(" ",(e=a.currentForm.get("id"))==null?null:e.value," ")}}function xe(t,s){if(t&1&&(l(0,"option",43),o(1),i()),t&2){let e=s.$implicit;d("value",e.id),r(),c(e.name)}}function Se(t,s){if(t&1&&(l(0,"select",61)(1,"option",41),o(2,"Select a district"),i(),g(3,xe,2,2,"option",42),i()),t&2){let e=p(2);r(3),d("ngForOf",e.districts)}}function ke(t,s){if(t&1&&(l(0,"div",62)(1,"div",63),o(2),i(),u(3,"input",64),i()),t&2){let e=p(2);r(2),c((e.selectedDistrict==null?null:e.selectedDistrict.name)||"-")}}function Ee(t,s){if(t&1&&(l(0,"div",54)(1,"div",37)(2,"label",58),o(3,"District"),i()(),l(4,"div",39),g(5,Se,4,1,"select",59)(6,ke,4,1,"div",60),i()()),t&2){let e=p();r(5),d("ngIf",e.needUpdate),r(),d("ngIf",!e.needUpdate)}}function Ce(t,s){if(t&1&&(l(0,"option",43),o(1),i()),t&2){let e=s.$implicit;d("value",e.id),r(),c(e.name)}}function ye(t,s){if(t&1&&(l(0,"select",67)(1,"option",41),o(2,"Select a taluka"),i(),g(3,Ce,2,2,"option",42),i()),t&2){let e=p(2);r(3),d("ngForOf",e.talukas)}}function De(t,s){if(t&1&&(l(0,"div",62)(1,"div",63),o(2),i(),u(3,"input",68),i()),t&2){let e=p(2);r(2),c((e.selectedTaluka==null?null:e.selectedTaluka.name)||"-")}}function Ie(t,s){if(t&1&&(l(0,"div",54)(1,"div",37)(2,"label",65),o(3,"Taluka"),i()(),l(4,"div",39),g(5,ye,4,1,"select",66)(6,De,4,1,"div",60),i()()),t&2){let e=p();r(5),d("ngIf",e.needUpdate),r(),d("ngIf",!e.needUpdate)}}function Me(t,s){t&1&&(l(0,"div",54)(1,"div",37)(2,"label",69),o(3,"Village Name"),i()(),l(4,"div",39),u(5,"input",70),i()())}function we(t,s){t&1&&(l(0,"div",54)(1,"div",37)(2,"label",71),o(3,"Gujarati Name"),i()(),l(4,"div",39),u(5,"input",72),i()())}function Fe(t,s){if(t&1){let e=E();l(0,"tr")(1,"th",73),o(2),i(),l(3,"td"),o(4),i(),l(5,"td"),o(6),i(),l(7,"td"),o(8),i(),l(9,"td",49)(10,"button",74),v("click",function(){let n=b(e).$implicit,m=p();return V(m.toggleVillageActive(n.id))}),o(11,"Restore"),i()()()}if(t&2){let e=s.$implicit,a=s.index;r(2),c(a+1),r(2),c(e.id),r(2),c(e.name),r(2),c(e.gu_name)}}var se=(()=>{class t{constructor(e,a,n,m,_,C,x,ce){this.districtService=e,this.talukaService=a,this.villageService=n,this.fb=m,this.DS=_,this.el=C,this.toastService=x,this.memberService=ce,this.villages=[],this.talukas=[],this.districts=[],this.needUpdate=!1,this.needAdd=!1;let w=this.fb.group({name:["",[f.required]],gu_name:[""],district_id:["",f.required],taluka_id:["",f.required],is_deleted:[!1]});this.villageForm=w;let pe=this.fb.group({id:["",[f.required]],name:["",f.required],gu_name:[""],district_id:["",f.required],taluka_id:["",f.required],is_deleted:[!1]});this.villageUpdateForm=pe,this.currentForm=w,this.filterVillage=this.fb.group({district:["",f.required],taluka:["",f.required]})}ngAfterViewInit(){this.villageModalElement=this.el.nativeElement.querySelector("#villageModal"),this.villageModalOptions={backdrop:!1,keyboard:!1},this.villageModal=new bootstrap.Modal(this.villageModalElement,this.villageModalOptions);let e=()=>{this.currentForm.get("district_id")?.setValue(this.selectedDistrict?.id),this.currentForm.get("taluka_id")?.setValue(this.selectedTaluka?.id),this.currentForm.get("is_deleted")?.setValue(!1)},a=()=>{this.villageData=null,this.villageModalTitle="",this.currentForm.reset(),this.needUpdate=!1,this.needAdd=!1},n=x=>{console.log(x)};this.villageModalElement.addEventListener("show.bs.modal",e),this.villageModalElement.addEventListener("hidden.bs.modal",a),this.villageModalElement.addEventListener("hide.bs.modal",n),this.villageDeletedModalElement=this.el.nativeElement.querySelector("#villageDeletedModal"),this.villageDeletedModalOptions={backdrop:!1,keyboard:!1},this.villageDeletedModal=new bootstrap.Modal(this.villageDeletedModalElement,this.villageDeletedModalOptions);let m=()=>{},_=()=>{},C=x=>{};this.villageDeletedModalElement.addEventListener("show.bs.modal",m),this.villageDeletedModalElement.addEventListener("hidden.bs.modal",_),this.villageDeletedModalElement.addEventListener("hide.bs.modal",C)}editVillage(e){this.currentForm=this.villageUpdateForm,this.currentForm.reset(),this.villageData=e,this.villageModalTitle="Edit "+e.name,this.currentForm.get("id")?.setValue(e.id),this.currentForm.get("name")?.setValue(e.name),this.currentForm.get("gu_name")?.setValue(e.gu_name),this.currentForm.get("is_deleted")?.setValue(!1),this.villageModal.show(),this.needUpdate=!0}addVillage(){this.currentForm=this.villageForm,this.currentForm.reset(),this.currentForm.get("taluka_id")?.setValue(this.selectedTaluka?.id),this.currentForm.get("is_deleted")?.setValue(!1),this.needAdd=!0,this.villageModalTitle="Add Village",this.villageModal.show()}saveVillage(){if(this.DS.markFormGroupTouched(this.currentForm),this.currentForm.valid)this.needUpdate&&this.updateVillage(this.currentForm.value),this.needAdd&&(this.newVillage=this.currentForm.value,this.addNewVillage()),this.villageModal.hide();else{let e=this.needUpdate?"Please enter valid data to update 'Village'":"Please enter valid data for 'New Village'";this.toastService.show(e,{class:"bg-danger"})}}ngOnInit(){this.loadDistrict(),this.filterVillage.get("district")?.valueChanges.subscribe(e=>{e&&(this.districtService.getDistrictById(e).subscribe(a=>{a&&(this.selectedDistrict=a)}),this.loadTaluka())}),this.filterVillage.get("taluka")?.valueChanges.subscribe(e=>{console.log(e),e&&(this.talukaService.getTalukaById(e).subscribe(a=>{a&&(this.selectedTaluka=a.data[0],console.log(this.selectedTaluka))}),this.loadVillage())})}loadDistrict(){this.districtService.getDistrict().subscribe(e=>{this.districts=e,e.length&&(e.sort((a,n)=>(a.name||"").localeCompare(n.name||"")),this.selectedDistrict=e[0],this.filterVillage.get("district")?.setValue(this.selectedDistrict?.id))})}loadTaluka(){let e=this.filterVillage.get("district")?.value;this.talukaService.getTalukaByDistrict(e).subscribe(a=>{this.talukas=a,a.sort((n,m)=>(n.name||"").localeCompare(m.name||"")),this.selectedTaluka=a[0],this.filterVillage.get("taluka")?.setValue(this.selectedTaluka?.id)},a=>{this.filterVillage.get("taluka")?.setValue(""),this.talukas=[],this.villages=[]})}loadVillage(){let e=this.filterVillage.get("taluka")?.value,a=this.filterVillage.get("district")?.value;this.villages=[],a&&e&&this.villageService.getVillageByTaluka(e).subscribe(n=>{n.sort((m,_)=>(m.name||"").localeCompare(_.name||"")),this.villages=n}),this.loadDeletedVillageLength()}addNewVillage(){this.villageService.addVillage(this.newVillage).subscribe(e=>{console.log("Village name updated successfully:",e),this.loadVillage()},e=>{console.error(e)})}deleteVillage(e){this.villageService.deleteVillage(e).subscribe(a=>{this.loadVillage(),this.loadDeletedVillageLength()},a=>{})}updateVillage(e){let a=e.id;this.villageService.updateVillageName(a,e).subscribe(n=>{console.log("Village name updated successfully:",n),this.loadVillage()},n=>{console.error("Error updating village name:",n)})}loadDeletedVillageLength(e){let a=this.selectedDistrict?.id,n=this.selectedTaluka?.id;a&&n&&this.villageService.getDeletedVillageLength(a,n).subscribe(m=>{this.deletedVillageCount=m.deletedvillagecount,m.deletedVillagesLength||this.villageDeletedModal.hide(),e&&this.openDeletedModal()},m=>{console.error("Error loading deleted village count:",m)})}loadDeletedVillage(){let e=this.selectedTaluka?.id;this.villageService.getDeletedVillage(e).subscribe(a=>{this.deletedVillageList=a},a=>{this.deletedVillageList=null})}toggleVillageActive(e){this.villageService.toggleVillageActive(e).subscribe(a=>{this.loadDeletedVillageLength(!0),this.loadDeletedVillage(),this.loadVillage(),console.log(a)},a=>{console.error("Error toggling village active state:",a)})}openDeletedModal(){this.loadDeletedVillage(),this.villageDeletedModal.show()}static{this.\u0275fac=function(a){return new(a||t)(h(ie),h(le),h(ae),h(X),h(re),h(L),h(oe),h(de))}}static{this.\u0275cmp=N({type:t,selectors:[["app-village"]],decls:77,vars:21,consts:[[1,"h-100","overflow-only-y","d-flex","flex-column"],[1,"container","pt-3"],["action","",1,"row","g-2","align-items-center",3,"formGroup"],[1,"col-lg-4","col-6"],["class","form-group row g-2 align-items-center",4,"ngIf"],[1,"col-auto","ms-auto"],[1,"btn","btn-success","me-2",3,"click"],[1,"fa","fa-plus","me-2"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"flex-grow-1","p-3","m-3","bg-white"],[1,"h-100","container","position-relative","overflow-y-auto","p-0"],[1,"position-absolute","h-100","w-100","table-responsive"],[1,"table","w-100","m-0","max-h-100-p","max-w-100-p","bg-white","text-nowrap"],[1,"sticky-top","bg-light"],[1,"text-center",3,"width"],["class","align-middle",4,"ngFor","ngForOf"],["id","villageModal","tabindex","-1","aria-labelledby","villageModalLabel",1,"modal","fade"],[1,"modal-dialog","modal-dialog-scrollable","p-0","my-0","modal-dialog-centered","position-relative","h-100"],[1,"modal-content"],[1,"modal-header","bg-success","py-2"],["id","villageModalLabel",1,"modal-title","text-white"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn",3,"click"],[1,"fa","fa-close","btn-flat","text-white"],[1,"modal-body","h-100","overflow-auto","py-0","my-3","d-flex","flex-column"],[1,"mt-3",3,"formGroup"],["class","form-group row g-2 align-items-center mb-3",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-md","btn-success","ms-2",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["id","villageDeletedModal","tabindex","-1","aria-labelledby","villageDeletedModalLabel",1,"modal","fade"],[1,"modal-dialog","modal-dialog-scrollable","modal-xl","modal-dialog-centered","position-relative","modal-dialog-scrollable"],["id","villageDeletedModalLabel",1,"modal-title","text-white"],[1,"table"],["scope","col"],["scope","col",1,"w-80-px","text-center"],[4,"ngFor","ngForOf"],[1,"form-group","row","g-2","align-items-center"],[1,"col-4","text-end"],["for","district",1,"form-label","mb-0"],[1,"col-8"],["id","district","formControlName","district","selectDropdown","",1,"form-select",3,"options"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","taluka",1,"form-label","mb-0"],["id","taluka","formControlName","taluka","selectDropdown","",1,"form-select",3,"options"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","me-2"],[1,"align-middle"],[1,"text-center"],[1,"btn","btn-flat","btn-md","me-2",3,"click"],[1,"fa","fa-edit"],[1,"btn","btn-flat","btn-md",3,"click"],[1,"fa","fa-trash"],[1,"form-group","row","g-2","align-items-center","mb-3"],["for","village-id",1,"form-label","mb-0"],[1,"form-control","bg-light"],["type","hidden","placeholder","","formControlName","id"],["for","district_id",1,"form-label","mb-0"],["class","form-select","id","district_id","formControlName","district_id",4,"ngIf"],["class","div",4,"ngIf"],["id","district_id","formControlName","district_id",1,"form-select"],[1,"div"],[1,"form-control"],["type","hidden","placeholder","","formControlName","district_id"],["for","taluka_id",1,"form-label","mb-0"],["class","form-select","id","taluka_id","formControlName","taluka_id",4,"ngIf"],["id","taluka_id","formControlName","taluka_id",1,"form-select"],["type","hidden","placeholder","","formControlName","taluka_id"],["for","taluka-name",1,"form-label","mb-0"],["type","text","placeholder","","formControlName","name","id","taluka-name",1,"form-control"],["for","gu_name",1,"form-label","mb-0"],["type","text","placeholder","","formControlName","gu_name","id","gu_name",1,"form-control"],["scope","row"],[1,"btn","btn-success","btn-sm",3,"click"]],template:function(a,n){a&1&&(l(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3),g(4,ve,9,2,"div",4),i(),l(5,"div",3),g(6,he,9,2,"div",4),i(),l(7,"div",5)(8,"button",6),v("click",function(){return n.addVillage()}),u(9,"i",7),o(10,"Add Taluka"),i(),g(11,_e,3,0,"button",8),i()()(),l(12,"div",9)(13,"div",10)(14,"div",11)(15,"table",12)(16,"thead",13)(17,"tr")(18,"th"),o(19,"No."),i(),l(20,"th"),o(21,"Code"),i(),l(22,"th"),o(23,"Name"),i(),l(24,"th"),o(25,"Gujarati Name"),i(),l(26,"th",14),o(27,"Action"),i()()(),l(28,"tbody"),g(29,be,14,4,"tr",15),i()()()()()(),l(30,"div",16)(31,"div",17)(32,"div",18)(33,"div",19)(34,"h5",20),o(35),i(),l(36,"button",21),v("click",function(){return n.villageModal.hide()}),u(37,"i",22),i()(),l(38,"div",23)(39,"form",24),g(40,Ve,8,1,"div",25)(41,Ee,7,2,"div",25)(42,Ie,7,2,"div",25)(43,Me,6,0,"div",25)(44,we,6,0,"div",25),i()(),l(45,"div",26)(46,"button",27),v("click",function(){return n.saveVillage()}),o(47,"Save"),i(),l(48,"button",28),v("click",function(){return n.villageModal.hide(!1)}),o(49,"Close"),i()()()()(),l(50,"div",29)(51,"div",30)(52,"div",18)(53,"div",19)(54,"h5",31),o(55),i(),l(56,"button",21),v("click",function(){return n.villageDeletedModal.hide()}),u(57,"i",22),i()(),l(58,"div",23),o(59),y(60,"json"),y(61,"json"),l(62,"table",32)(63,"thead")(64,"tr")(65,"th",33),o(66,"No."),i(),l(67,"th",33),o(68,"ID"),i(),l(69,"th",33),o(70,"Name"),i(),l(71,"th",33),o(72,"Gujarati Name"),i(),l(73,"th",34),o(74,"Actions"),i()()(),l(75,"tbody"),g(76,Fe,12,4,"tr",35),i()()()()()()),a&2&&(r(2),d("formGroup",n.filterVillage),r(2),d("ngIf",n.filterVillage.get("district")),r(2),d("ngIf",n.filterVillage.get("taluka")),r(5),d("ngIf",n.deletedVillageCount>0),r(15),d("width",100),r(3),d("ngForOf",n.villages),r(6),c(n.villageModalTitle),r(4),d("formGroup",n.currentForm),r(),d("ngIf",n.currentForm.get("id")!==null&&n.needUpdate),r(),d("ngIf",n.currentForm.get("district_id")),r(),d("ngIf",n.currentForm.get("taluka_id")),r(),d("ngIf",n.currentForm.get("name")!==null),r(),d("ngIf",n.currentForm.get("gu_name")!==null),r(11),c(n.villageDeletedModalTitle),r(4),O(" ",D(60,17,n.selectedDistrict)," ",D(61,19,n.selectedTaluka)," "),r(17),d("ngForOf",n.deletedVillageList))},dependencies:[A,U,ee,te,P,Q,W,B,K,R,H,J,z,$]})}}return t})();var Te=[{path:"",component:se,data:{title:"Village",breadcrumb:"Village"}}],me=(()=>{class t{static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275mod=k({type:t})}static{this.\u0275inj=S({imports:[I.forChild(Te),I]})}}return t})();var et=(()=>{class t{static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275mod=k({type:t})}static{this.\u0275inj=S({imports:[q,me,ne,Z,Y]})}}return t})();export{et as VillageModule};
