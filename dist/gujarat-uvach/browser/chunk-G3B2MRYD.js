import{a as U}from"./chunk-SXPODWY5.js";import"./chunk-M63T62QT.js";import{a as V}from"./chunk-2S7OECMZ.js";import{a as j}from"./chunk-XSXBVDCX.js";import{a as B}from"./chunk-3PIGAWKT.js";import"./chunk-6TAJW53V.js";import{c as G,f as D,j as W,y as F,z as q}from"./chunk-OVKDPXDD.js";import{t as R,u as T,w as h}from"./chunk-KKCOZWDK.js";import{$c as N,Aa as g,Ba as p,Jb as r,Kb as s,Lb as w,M as C,Mb as S,Nb as b,Ob as y,Qb as M,Sb as l,ac as c,cc as _,ec as P,fb as n,fc as k,gb as m,gc as I,ha as u,id as E,ra as A,sa as f,t as x,xb as v,zb as d}from"./chunk-PXJRLMEI.js";import"./chunk-CWTPBX7D.js";function J(t,L){if(t&1){let e=y();S(0),w(1,"router-outlet")(2,"span",4),r(3,"p",5),c(4,"Connect with us by"),s(),r(5,"div",6)(6,"button",7),M("click",function(){g(e);let i=l();return p(i.registerWithGoogle())}),w(7,"i",8),c(8),s()(),b()}if(t&2){let e=l();n(6),d("disabled",e.isLoading),n(2),_(" ",e.isLoading?"Loading...":"Google"," ")}}function K(t,L){if(t&1&&(r(0,"div",15),c(1),s()),t&2){let e=l(2);n(),_(" ",e.errorMessage," ")}}function Q(t,L){if(t&1){let e=y();S(0),r(1,"h5",9),c(2,"Set Your Password"),s(),r(3,"div",10)(4,"label",11),c(5,"New Password"),s(),r(6,"input",12),I("ngModelChange",function(i){g(e);let a=l();return k(a.newPassword,i)||(a.newPassword=i),p(i)}),s()(),r(7,"div",10)(8,"label",11),c(9,"Confirm Password"),s(),r(10,"input",12),I("ngModelChange",function(i){g(e);let a=l();return k(a.confirmPassword,i)||(a.confirmPassword=i),p(i)}),s()(),v(11,K,2,1,"div",13),r(12,"button",14),M("click",function(){g(e);let i=l();return p(i.onSubmitNewPassword())}),c(13),s(),b()}if(t&2){let e=l();n(6),P("ngModel",e.newPassword),d("disabled",e.isLoading),n(4),P("ngModel",e.confirmPassword),d("disabled",e.isLoading),n(),d("ngIf",e.errorMessage),n(),d("disabled",e.isLoading),n(),_(" ",e.isLoading?"Saving...":"Save Password"," ")}}var O=(()=>{class t{constructor(e,o,i,a,H){this.router=e,this.registerService=o,this.authService=i,this.toast=a,this.cookie=H,this.isLoading=!1,this.errorMessage="",this.showSetPassword=!1,this.googleUserId="",this.newPassword="",this.confirmPassword=""}handleGoogleCredential(e){console.log("Google response:",e);try{let o=e.credential;this.isLoading=!0,this.errorMessage="",this.registerService.googleAuth(o).pipe(C(i=>(this.isLoading=!1,this.toast.show(i.message||"Google auth failed",{class:"bg-danger"}),x(null)))).subscribe(i=>{if(this.isLoading=!1,!!i&&i.token){let a={path:"/",secure:window.location.protocol==="https:",sameSite:"Lax"};this.authService.setToken(i.token),i.requiresPassword}})}catch(o){console.error("handleGoogleCredential error:",o),this.toast.show("Internal error processing Google response",{class:"bg-danger"}),this.isLoading=!1}}registerWithGoogle(){this.isLoading=!0,google.accounts.id.initialize({client_id:"650577899089-abc77o2gr9jldf1sfi6rcg6gptcdq4p8.apps.googleusercontent.com",callback:e=>this.handleGoogleCredential(e)}),google.accounts.id.prompt(e=>{console.group("GSI Prompt Notification"),console.log("NotDisplayed?",e.isNotDisplayed(),e.getNotDisplayedReason()),console.log("Skipped?",e.isSkippedMoment(),e.getSkippedReason()),console.log("Dismissed?",e.isDismissedMoment(),e.getDismissedReason()),console.groupEnd()})}onSubmitNewPassword(){if(this.newPassword!==this.confirmPassword){this.errorMessage="Passwords do not match";return}this.isLoading=!0,this.registerService.setPassword(this.googleUserId,this.newPassword).pipe(C(e=>(this.isLoading=!1,this.toast.show(e.message||"Could not set password",{class:"bg-danger"}),x(null)))).subscribe(e=>{this.isLoading=!1,e?.token&&(this.authService.setToken(e.token),this.router.navigate(["/home"]))})}static{this.\u0275fac=function(o){return new(o||t)(m(T),m(U),m(V),m(B),m(j))}}static{this.\u0275cmp=A({type:t,selectors:[["app-authentication"]],decls:6,vars:2,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100","flex-column"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],["src","assets/images/svg/logo-large.svg","alt","logo",1,"w-66-p","mx-auto","mb-3"],[4,"ngIf"],[1,"or-container"],[1,"text-center"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","btn-outline-danger","border","w-100","me-2",3,"click","disabled"],[1,"fa","fa-google","me-3"],[1,"mb-3","text-center"],[1,"mb-3"],[1,"form-label"],["type","password",1,"form-control",3,"ngModelChange","ngModel","disabled"],["class","alert alert-danger py-1",4,"ngIf"],[1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"alert","alert-danger","py-1"]],template:function(o,i){o&1&&(r(0,"div",0)(1,"div",1),w(2,"img",2)(3,"hr"),v(4,J,9,2,"ng-container",3)(5,Q,14,7,"ng-container",3),s()()),o&2&&(n(4),d("ngIf",!i.showSetPassword),n(),d("ngIf",i.showSetPassword))},dependencies:[N,R,G,D,W]})}}return t})();var X=[{path:"",component:O,data:{title:"PostNew | Authentication",description:"Login or register to PostNew portal for accessing services",keywords:"PostNew, login, register, authentication, portal",robots:"index, follow"},children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadChildren:()=>import("./chunk-IVQ6B4FW.js").then(t=>t.LoginModule)},{path:"register",loadChildren:()=>import("./chunk-5LS5JLGM.js").then(t=>t.RegisterModule)},{path:"forgot-password",loadChildren:()=>import("./chunk-SMD75S7Z.js").then(t=>t.ForgotPasswordModule)},{path:"reset-password",loadChildren:()=>import("./chunk-UI2URTJP.js").then(t=>t.ResetPasswordModule)},{path:"verify-email",loadChildren:()=>import("./chunk-6OI57AO6.js").then(t=>t.VerifyEmailModule)}]}],Y=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=f({type:t})}static{this.\u0275inj=u({imports:[h.forChild(X),h]})}}return t})();var fe=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=f({type:t})}static{this.\u0275inj=u({imports:[E,h,Y,F,q]})}}return t})();export{fe as AuthenticationModule};
