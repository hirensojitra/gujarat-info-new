import{a as c}from"./chunk-DMITPIK3.js";import{J as r,M as i,Nb as n,e as s}from"./chunk-4GDYXFLP.js";var d=(()=>{class o{constructor(e,t){this.cookie=e,this.router=t,this.userSubject=new s(this.loadUser()),this.user$=this.userSubject.asObservable()}loadUser(){let e=this.cookie.get("user");try{return e?JSON.parse(e):null}catch{return null}}getUser(){return this.userSubject.value}setUser(e){let t=JSON.stringify(e);this.cookie.set("user",t,7,"/",void 0,window.location.protocol==="https:","Lax"),this.userSubject.next(e)}setToken(e){let t=window.location.protocol==="https:";this.cookie.set("token",e,7,"/",void 0,t,"Lax")}getToken(){return this.cookie.get("token")}logout(){this.cookie.delete("token","/"),this.cookie.delete("user","/"),this.userSubject.next(null),this.router.navigate(["/authentication/login"])}isLoggedIn(){return!!this.getToken()&&!!this.getUser()}saveSession(e,t){this.cookie.deleteAll("/");let u=window.location.protocol==="https:";this.cookie.set("token",e,{path:"/",secure:u,sameSite:"Lax"}),this.setUser(t),console.log(e)}static{this.\u0275fac=function(t){return new(t||o)(i(c),i(n))}}static{this.\u0275prov=r({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{d as a};
