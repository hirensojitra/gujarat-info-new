import{a as N}from"./chunk-IBJUZ6QP.js";import{b as q,f as Q,r as $}from"./chunk-FX65QOBZ.js";import"./chunk-637AZWOF.js";import"./chunk-TF3KVUAE.js";import"./chunk-77ITHIYP.js";import{Aa as g,Da as M,E as f,Ea as R,Fa as V,Ga as k,Gb as B,Ha as s,Ia as T,Ib as G,J as D,Ja as _,K as v,Kb as y,P as d,Q as m,Qa as z,R as C,S,X as E,Xa as j,aa as l,ba as u,fb as F,gb as L,la as w,na as h,nb as A,ob as O,ta as o,ua as n,va as p,ya as x,za as c}from"./chunk-6SCNQMZS.js";import"./chunk-CWTPBX7D.js";var Y=["masonryGrid"],J=()=>[12,24,48];function K(t,b){if(t&1){let e=x();o(0,"div",25)(1,"div",26),C(),o(2,"svg",27),c("backgroundLoaded",function(){d(e);let i=g(2);return m(i.onSvgLoad())}),n(),S(),o(3,"div",28)(4,"div",29)(5,"a",30),c("click",function(){let i=d(e).$implicit;return g(2).selectRecoverId(i.id),m(!1)}),p(6,"i",31),n(),o(7,"a",32),c("click",function(){let i=d(e).$implicit;return g(2).selectDeleteId(i.id),m(!1)}),p(8,"i",33),n()()(),o(9,"span",34),s(10),n()()()}if(t&2){let e=b.$implicit;l(2),h("postDataSet",e)("loadOnly",!0),l(8),_(" ",e.download_counter," ")}}function X(t,b){if(t&1&&(o(0,"div",23,1),w(2,K,11,3,"div",24),n()),t&2){let e=g();l(2),h("ngForOf",e.posts)}}function Z(t,b){if(t&1&&(o(0,"div",35)(1,"p"),s(2),n()()),t&2){let e=g();l(2),T(e.post_msg)}}var U=(()=>{class t{constructor(e,r,i,a){this.PS=e,this.route=r,this.router=i,this.platformId=a,this.posts=[],this.currentPage=1,this.totalPages=0,this.totalPosts=0,this.limit=12,this.post_msg="Loading deleted posts",this.isBrowser=O(this.platformId)}ngOnInit(){this.route.queryParams.subscribe(e=>{this.currentPage=+e.page||1,this.limit=+e.limit||this.limit,this.loadPosts()}),this.window=window,this.confirmRecover=new bootstrap.Modal(document.getElementById("confirmRecover"),{}),this.hardDeleteModal=new bootstrap.Modal(document.getElementById("hardDeleteModal"),{})}ngAfterViewInit(){this.isBrowser&&window.addEventListener("resize",()=>{this.masonryInstance&&this.masonryInstance.layout()})}loadPosts(){this.PS.getAllSoftDeletedPosts({page:this.currentPage,limit:this.limit}).subscribe(e=>{this.posts=e.posts,this.totalPosts=e.pagination.totalPosts,this.totalPages=Math.ceil(this.totalPosts/this.limit),setTimeout(()=>this.initializeMasonry(),0),this.post_msg="No deleted posts available."})}initializeMasonry(){this.masonryGridRef&&(this.masonryInstance=new Masonry(this.masonryGridRef.nativeElement,{itemSelector:".col-lg-2",columnWidth:".col-lg-2",percentPosition:!0}))}selectRecoverId(e){this.selectedID=e,e&&this.confirmRecover.show()}selectDeleteId(e){this.selectedID=e,e&&this.hardDeleteModal.show()}recoverPost(){this.selectedID&&this.PS.recoverPost(this.selectedID).subscribe(()=>{this.confirmRecover.hide(),this.loadPosts()})}hardDelete(){this.selectedID&&this.PS.hardDeletePost(this.selectedID).subscribe(()=>{this.hardDeleteModal.hide(),this.loadPosts()})}onPageChange(e){this.currentPage!==e&&(this.currentPage=e,this.updateUrlParams())}changePage(e){this.currentPage!=e&&(this.currentPage=e,this.loadPosts())}changePageSize(e){this.limit!=e&&(this.limit=e,this.currentPage=1,this.loadPosts())}getPaginationControls(){return Array.from({length:this.totalPages},(e,r)=>r+1)}updateUrlParams(){this.router.navigate([],{queryParams:{page:this.currentPage,limit:this.limit},queryParamsHandling:"merge"})}onSvgLoad(){this.masonryInstance&&this.isBrowser&&window.dispatchEvent(new Event("resize"))}static{this.\u0275fac=function(r){return new(r||t)(u(N),u(B),u(G),u(E))}}static{this.\u0275cmp=D({type:t,selectors:[["app-image-deleted"]],viewQuery:function(r,i){if(r&1&&M(Y,5),r&2){let a;R(a=V())&&(i.masonryGridRef=a.first)}},decls:45,vars:9,consts:[["noPosts",""],["masonryGrid",""],[1,"h-100","d-flex","flex-column","p-3"],[1,"flex-grow-1","position-relative","overflow-hidden"],[1,"position-absolute","h-100","w-100","d-flex","overflow-auto","flex-column"],[1,"container","h-100","w-100","p-md-3","p-2"],["class","row g-md-3 g-2","data-masonry","{'percentPosition': true}",4,"ngIf","ngIfElse"],["pagination","",1,"mt-0","mb-0","px-3",3,"currentPageChange","pageSizeChange","currentPage","totalItems","pageSize","pageSizes"],["id","confirmRecover","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-success","text-white"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","id","btnDelete",1,"btn","btn-success",3,"click"],[1,"fa","fa-refresh","me-2"],["id","hardDeleteModal","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-header","bg-danger","text-white"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","text-white"],["type","button","id","btnDelete",1,"btn","btn-danger",3,"click"],["data-masonry","{'percentPosition': true}",1,"row","g-md-3","g-2"],["class","col-lg-2 col-md-3 col-sm-4 col-6 masonry-box",4,"ngFor","ngForOf"],[1,"col-lg-2","col-md-3","col-sm-4","col-6","masonry-box"],[1,"position-relative","border","p-2"],["preserveAspectRatio","xMidYMid meet","svgDraw","",1,"svg-content","max-w-100-p","max-h-100-p","img-fluid","mx-auto","d-block",3,"backgroundLoaded","postDataSet","loadOnly"],[1,"d-flex","flex-column","position-absolute","start-0","top-0","h-100","w-100","p-3"],[1,"d-flex","mb-auto"],["href","#",1,"btn","btn-success","btn-sm","me-auto",3,"click"],[1,"fa","fa-refresh"],["href","#",1,"btn","btn-danger","btn-sm","ms-auto",3,"click"],[1,"fa","fa-trash"],[1,"position-absolute","top-100","start-50","translate-middle","badge","rounded-pill","bg-danger"],[1,"text-center","py-3"]],template:function(r,i){if(r&1){let a=x();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),w(4,X,3,1,"div",6)(5,Z,3,1,"ng-template",null,0,j),o(7,"div",7),c("currentPageChange",function(P){return d(a),m(i.changePage(P))})("pageSizeChange",function(P){return d(a),m(i.changePageSize(P))}),n()()()()(),o(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"h5",12),s(13,"Confirm Restore"),n(),p(14,"button",13),n(),o(15,"div",14)(16,"p"),s(17,"Are you sure you want to Restore "),o(18,"b"),s(19),n(),s(20,"?"),n()(),o(21,"div",15)(22,"button",16),s(23,"Cancel"),n(),o(24,"button",17),c("click",function(){return d(a),m(i.recoverPost())}),p(25,"i",18),s(26,"Restore"),n()()()()(),o(27,"div",19)(28,"div",9)(29,"div",10)(30,"div",20)(31,"h5",12),s(32,"Confirm Delete"),n(),p(33,"button",21),n(),o(34,"div",14)(35,"p"),s(36,"Are you sure you want to delete "),o(37,"b"),s(38),n(),s(39,"?"),n()(),o(40,"div",15)(41,"button",16),s(42,"Cancel"),n(),o(43,"button",22),c("click",function(){return d(a),m(i.hardDelete())}),s(44,"Delete"),n()()()()()}if(r&2){let a=k(6);l(4),h("ngIf",i.posts.length)("ngIfElse",a),l(3),h("currentPage",i.currentPage)("totalItems",i.totalPosts)("pageSize",i.limit)("pageSizes",z(8,J)),l(12),_('"',i.selectedID,'"'),l(19),_('"',i.selectedID,'"')}},dependencies:[F,L,q,Q]})}}return t})();var ee=[{path:"",component:U,data:{title:"Deleted Images",breadcrumb:"Deleted Images"}}],W=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=v({type:t})}static{this.\u0275inj=f({imports:[y.forChild(ee),y]})}}return t})();var Ie=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=v({type:t})}static{this.\u0275inj=f({imports:[A,W,$]})}}return t})();export{Ie as ImageDeletedModule};
