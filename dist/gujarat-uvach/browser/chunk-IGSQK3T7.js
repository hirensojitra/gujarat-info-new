import{a as j}from"./chunk-MOG3XBX6.js";import{a as x}from"./chunk-L7PFNTAI.js";import{a as k}from"./chunk-I5B5QVLH.js";import"./chunk-2BGOZAMS.js";import"./chunk-UZIG45QV.js";import{a as C}from"./chunk-77ITHIYP.js";import{E as n,Ha as u,Ib as w,J as g,Jb as M,K as a,Lb as s,ba as r,k as c,nb as v,sb as b,ta as l,u as d,ua as h,va as p,za as f}from"./chunk-DET3BHZI.js";import"./chunk-CWTPBX7D.js";var A=(()=>{class e{constructor(t,o,i,m,S){this.router=t,this.userService=o,this.authService=i,this.toast=m,this.http=S,this.api=C.MasterApi,this.isLoading=!1,this.errorMessage=""}ngAfterViewInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"])}handleGoogleCredential(t){let o=t.credential;console.log("Google idToken:",o),this.http.post(this.api+"/auth/google",{idToken:o},{responseType:"json"}).pipe(d(i=>(this.isLoading=!1,this.toast.show(i.error?.message||"Google authentication failed.",{class:"bg-danger"}),c(null)))).subscribe({next:i=>{this.isLoading=!1,i&&i.token?(console.log(i),this.userService.setUser(i),this.authService.setToken(i.token),this.router.navigate(["/dashboard"])):this.toast.show("Unable to process Google registration.",{class:"bg-danger"})},error:i=>{this.isLoading=!1,this.toast.show(i.message||"Google authentication failed.",{class:"bg-danger"})},complete:()=>{this.isLoading=!1}})}registerWithGoogle(){this.isLoading=!0,this.errorMessage="",google.accounts.id.initialize({client_id:"650577899089-eq5q93v869b5qvi6vllcq81o8v06ubsm.apps.googleusercontent.com",callback:t=>this.handleGoogleCredential(t)}),google.accounts.id.prompt()}registerWithFacebook(){this.isLoading=!0,this.errorMessage="",this.http.get(this.api+"/auth/facebook",{responseType:"json"}).pipe(d(t=>(this.errorMessage=t.error?.message||"Facebook registration failed.",this.isLoading=!1,c(null)))).subscribe(t=>{this.isLoading=!1,t&&t.redirectUrl?window.location.href=t.redirectUrl:this.errorMessage="Unable to process Facebook registration."})}static{this.\u0275fac=function(o){return new(o||e)(r(M),r(j),r(k),r(x),r(b))}}static{this.\u0275cmp=g({type:e,selectors:[["app-auth"]],decls:10,vars:0,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100","flex-column"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],[1,"or-container"],[1,"text-center"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","btn-outline-danger","border","w-100","me-2",3,"click"],[1,"fa","fa-google","me-3"]],template:function(o,i){o&1&&(l(0,"div",0)(1,"div",1),p(2,"router-outlet")(3,"span",2),l(4,"p",3),u(5,"Connect with us by"),h(),l(6,"div",4)(7,"button",5),f("click",function(){return i.registerWithGoogle()}),p(8,"i",6),u(9,"Google"),h()()()())},dependencies:[w]})}}return e})();var G=[{path:"",component:A,data:{title:"PostNew | Authentication",description:"Login or register to PostNew portal for accessing services",keywords:"PostNew, login, register, authentication, portal",robots:"index, follow"},children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadChildren:()=>import("./chunk-4JYTDRXH.js").then(e=>e.LoginModule)},{path:"register",loadChildren:()=>import("./chunk-WQYJX3BA.js").then(e=>e.RegisterModule)},{path:"forgot-password",loadChildren:()=>import("./chunk-Y2SGNGQG.js").then(e=>e.ForgotPasswordModule)},{path:"reset-password",loadChildren:()=>import("./chunk-2ONGX3MF.js").then(e=>e.ResetPasswordModule)}]}],L=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=a({type:e})}static{this.\u0275inj=n({imports:[s.forChild(G),s]})}}return e})();var B=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=a({type:e})}static{this.\u0275inj=n({imports:[v,s,L]})}}return e})();export{B as AuthModule};
