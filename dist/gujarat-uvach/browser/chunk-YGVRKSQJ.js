import{a as te}from"./chunk-FWQ4NX6E.js";import{a as H}from"./chunk-VY5QVZBD.js";import"./chunk-I4RV6RFQ.js";import{m as ie,r as ne}from"./chunk-Z47E2FOE.js";import{a as Q}from"./chunk-WIB4C2YZ.js";import"./chunk-7URJ3TZA.js";import{c as Y,f as J,j as K,s as X,t as Z,u as $,y as ee}from"./chunk-BCINQI2X.js";import{s as O,u as G,v as q,w as S}from"./chunk-3SANXGOA.js";import{$a as M,$b as d,Aa as m,Dc as D,Ib as o,Jb as a,Kb as x,Lb as T,Mb as B,Na as L,Nb as w,Pb as u,Rb as s,Xb as z,Yb as k,Zb as A,Zc as U,_c as F,bc as R,dc as C,eb as c,ec as I,fb as p,fc as P,ga as v,hd as N,ic as j,jd as W,lb as V,qa as b,ra as y,wb as h,xb as E,yb as g,za as l}from"./chunk-NIQGYGOG.js";import{f}from"./chunk-CWTPBX7D.js";var me=["masonryGrid"],de=()=>[10,20,30];function ge(n,_){if(n&1){let e=w();o(0,"a",30),u("click",function(){l(e);let t=s().$implicit;return s(3).navigateToEdit(t.id),m(!1)}),x(1,"i",31),d(2,"Edit "),a()}}function pe(n,_){if(n&1){let e=w();o(0,"div",20)(1,"div",21)(2,"div",22)(3,"img",23),u("load",function(t){l(e);let r=s(3);return m(r.onSvgLoad(t))}),a(),o(4,"div",24),h(5,ge,3,0,"a",25),o(6,"a",26),x(7,"i",27),d(8,"View "),a()(),o(9,"span",28),d(10),o(11,"span",29),d(12,"unread messages"),a()()()()()}if(n&2){let e=_.$implicit,i=s(3);c(3),g("src",i.imgUrl+e.id,M),E("alt",e.title),c(2),g("ngIf",i.isUserAdmin),c(),g("routerLink","/poster/"+e.id),c(4),R(" Download: ",e.download_counter," ")}}function ue(n,_){if(n&1&&(T(0),o(1,"div",17)(2,"div",18,0),h(4,pe,13,5,"div",19),a()(),B()),n&2){let e=s(2);c(4),g("ngForOf",e.posts)}}function he(n,_){if(n&1){let e=w();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"button",6),x(5,"i",7),d(6,"Image"),a()(),o(7,"div",5)(8,"div",8)(9,"input",9),P("ngModelChange",function(t){l(e);let r=s();return I(r.search,t)||(r.search=t),m(t)}),u("input",function(){l(e);let t=s();return m(t.changePage(1))}),a(),o(10,"select",10),P("ngModelChange",function(t){l(e);let r=s();return I(r.sortBy,t)||(r.sortBy=t),m(t)}),u("change",function(){l(e);let t=s();return m(t.changePage(1))}),o(11,"option",11),d(12,"Date Created"),a(),o(13,"option",12),d(14,"Title"),a()(),o(15,"select",10),P("ngModelChange",function(t){l(e);let r=s();return I(r.order,t)||(r.order=t),m(t)}),u("change",function(){l(e);let t=s();return m(t.changePage(1))}),o(16,"option",13),d(17,"Ascending"),a(),o(18,"option",14),d(19,"Descending"),a()()()(),h(20,ue,5,1,"ng-container",15),a(),o(21,"div",16),u("currentPageChange",function(t){l(e);let r=s();return m(r.changePage(t))})("pageSizeChange",function(t){l(e);let r=s();return m(r.changePageSize(t))}),a()()()}if(n&2){let e=s();c(4),g("routerLink","/images/generate"),c(5),C("ngModel",e.search),c(),C("ngModel",e.sortBy),c(5),C("ngModel",e.order),c(5),g("ngIf",e.posts.length),c(),g("currentPage",e.currentPage)("totalItems",e.pagination.totalPosts)("pageSize",e.limit)("pageSizes",j(9,de))}}var oe=(()=>{class n{constructor(e,i,t,r,ae,ce,le){this.PS=e,this.route=i,this.router=t,this.authService=r,this.platformId=ae,this.cdr=ce,this.renderer=le,this.posts=[],this.currentPage=1,this.limit=12,this.search="",this.sortBy="created_at",this.order="desc",this.pagination={totalPosts:0,currentPage:1,totalPages:0},this.imgUrl=Q.MasterApi+"/thumb-images/",this.isUserAdmin=!1,this.isBrowser=W(this.platformId)}ngOnInit(){return f(this,null,function*(){this.isUserAdmin=this.authService.hasRole(["admin","master"]),this.route.queryParams.subscribe(e=>f(this,null,function*(){this.currentPage=+e.page||1,this.limit=+e.limit||this.limit,this.search=e.search||this.search,this.sortBy=e.sortBy||this.sortBy,this.order=e.order||this.order,yield this.getAllPosts()}))})}ngAfterViewInit(){this.isBrowser&&(this.initializeMasonry(),window.addEventListener("resize",()=>{this.masonryInstance&&this.masonryInstance.layout()}))}initializeMasonry(){this.masonryGridRef&&this.isBrowser&&(console.log("Initializing Masonry:",this.masonryGridRef.nativeElement),this.masonryInstance=new Masonry(this.masonryGridRef.nativeElement,{itemSelector:".masonry-box",percentPosition:!0}))}getAllPosts(){return f(this,null,function*(){this.PS.getAllPosts({page:this.currentPage,limit:this.limit,search:this.search,sortBy:this.sortBy,order:this.order,published:void 0,info_show:void 0}).subscribe(e=>{this.posts=e.posts,this.pagination=e.pagination,this.cdr.detectChanges(),this.masonryInstance?(this.masonryInstance.reloadItems(),this.masonryInstance.layout()):this.initializeMasonry()})})}changePage(e){this.currentPage!=e&&(this.currentPage=e,this.updateUrlParams(),this.getAllPosts())}changePageSize(e){this.limit!=e&&(this.limit=e,this.currentPage=1,this.updateUrlParams(),this.getAllPosts())}updateUrlParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{page:this.currentPage,limit:this.limit,search:this.search,sortBy:this.sortBy,order:this.order},queryParamsHandling:"merge"})}onSvgLoad(e){let t=e.target.parentElement;t&&this.renderer.removeClass(t,"opacity-0"),this.masonryInstance&&this.isBrowser&&window.dispatchEvent(new Event("resize"))}navigateToEdit(e){let i={queryParams:{img:e}},t=this.router.createUrlTree(["/images/generate"],i),r=this.router.serializeUrl(t);window.open(r,"_blank")}static{this.\u0275fac=function(i){return new(i||n)(p(te),p(O),p(G),p(H),p(L),p(D),p(V))}}static{this.\u0275cmp=b({type:n,selectors:[["app-image-list"]],viewQuery:function(i,t){if(i&1&&z(me,5),i&2){let r;k(r=A())&&(t.masonryGridRef=r.first)}},decls:1,vars:1,consts:[["masonryGrid",""],["class","position-absolute h-100 w-100 d-flex overflow-auto flex-column",4,"ngIf"],[1,"position-absolute","h-100","w-100","d-flex","overflow-auto","flex-column"],[1,"container","h-100","w-100"],[1,"row","g-3"],[1,"col-6","pb-3"],["target","_blank","type","button",1,"btn","btn-success",3,"routerLink"],[1,"fa","fa-plus","me-2"],[1,"search-sort-container"],["placeholder","Search posts",3,"ngModelChange","input","ngModel"],[3,"ngModelChange","change","ngModel"],["value","created_at"],["value","title"],["value","asc"],["value","desc"],[4,"ngIf"],["pagination","",1,"mt-0","mb-0","px-3",3,"currentPageChange","pageSizeChange","currentPage","totalItems","pageSize","pageSizes"],[1,"col-12","px-md-3","px-2"],["data-masonry","{'percentPosition': true}",1,"row","g-md-3","g-2"],["class","col-lg-3 col-md-3 col-sm-4 col-6 masonry-box",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-3","col-sm-4","col-6","masonry-box"],[1,"shadow","img-container"],[1,"position-relative","border","p-1","opacity-0"],[1,"w-100","img-fluid","d-block",3,"load","src"],["role","group",1,"btn-group","w-100"],["class","btn btn-secondary btn-sm rounded-0 m-1","target","_blank",3,"click",4,"ngIf"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0","m-1",3,"routerLink"],[1,"fa","fa-eye","me-2"],[1,"position-absolute","top-0","start-50","translate-middle","badge","rounded-pill","bg-danger","d-none","d-md-block"],[1,"visually-hidden"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0","m-1",3,"click"],[1,"fa","fa-edit","me-2"]],template:function(i,t){i&1&&h(0,he,22,10,"div",1),i&2&&g("ngIf",t.isBrowser)},dependencies:[U,F,q,ie,Z,$,Y,X,J,K]})}}return n})();var _e=[{path:"",component:oe,data:{title:"Image List",breadcrumb:"Image List",description:"Your Page Description"}}],se=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=v({imports:[S.forChild(_e),S]})}}return n})();var Fe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=v({imports:[N,se,ne,ee]})}}return n})();export{Fe as ImageListModule};
