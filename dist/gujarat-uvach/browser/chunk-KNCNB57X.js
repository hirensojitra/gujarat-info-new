import{a as ee}from"./chunk-F54JW7TG.js";import{b as U}from"./chunk-QBRTSGNY.js";import{a as Z}from"./chunk-OGYA6K2F.js";import{e as Y,f as z,g as H,h as K,p as X}from"./chunk-W4G6GZ5A.js";import{a as Q}from"./chunk-F7S2VGP6.js";import"./chunk-X6E4KI7S.js";import{c as M,d as f,f as $,g as j,k as O,o as A,r as q,s as R,t as G,u as L,w as B,x as J,y as W}from"./chunk-2V5UGUD5.js";import"./chunk-QHXDM6TZ.js";import{Aa as x,B as v,Ba as E,G as b,Ia as l,Ja as _,L as C,Lb as w,M as S,Mb as k,Va as I,Wa as T,ba as a,ca as u,gb as P,hb as D,i as y,ma as p,mb as N,oa as n,ob as V,ua as o,va as i,wa as g}from"./chunk-6PSXH6NM.js";function le(t,m){t&1&&(o(0,"div",15)(1,"div",16)(2,"label",17),l(3,"First Name"),i(),g(4,"input",18),i()())}function ae(t,m){t&1&&(o(0,"div",15)(1,"div",16)(2,"label",17),l(3,"Last Name"),i(),g(4,"input",19),i()())}function ne(t,m){t&1&&(o(0,"div",15)(1,"div",16)(2,"label",17),l(3,"Phone number"),i(),o(4,"div",20)(5,"div",21),l(6,"+91"),i(),g(7,"input",22),i()()())}function de(t,m){if(t&1&&(o(0,"option",27),l(1),i()),t&2){let e=m.$implicit;n("value",e.id),a(),_(e.name)}}function me(t,m){if(t&1&&(o(0,"div",16)(1,"label",23),l(2,"District"),i(),o(3,"select",24)(4,"option",25),l(5,"Select a district"),i(),p(6,de,2,2,"option",26),i()()),t&2){let e=E();a(3),n("options",e.districts),a(3),n("ngForOf",e.districts)}}function ce(t,m){if(t&1&&(o(0,"option",27),l(1),i()),t&2){let e=m.$implicit;n("value",e.id),a(),_(e.name)}}function ue(t,m){if(t&1&&(o(0,"div",16)(1,"label",28),l(2,"Taluka"),i(),o(3,"select",29)(4,"option",25),l(5,"Select a Taluka"),i(),p(6,ce,2,2,"option",26),i()()),t&2){let e=E();a(6),n("ngForOf",e.talukas)}}function pe(t,m){if(t&1&&(o(0,"option",27),l(1),i()),t&2){let e=m.$implicit;n("value",e.id),a(),_(e.name)}}function fe(t,m){if(t&1&&(o(0,"div",16)(1,"label",30),l(2,"Village"),i(),o(3,"select",31)(4,"option",25),l(5,"Select a Village"),i(),p(6,pe,2,2,"option",26),i()()),t&2){let e=E();a(6),n("ngForOf",e.villages)}}var ie=(()=>{class t{constructor(e,r,s,h,d,F,oe){this.fb=e,this.userService=r,this.districtService=s,this.talukaService=h,this.villageService=d,this.DS=F,this.toastService=oe,this.districts=[],this.talukas=[],this.villages=[],this.destroy$=new y,this.userForm=this.fb.group({firstname:["",f.required],lastname:["",f.required],mobile:["",f.required],district_id:[null,f.required],taluka_id:[null,f.required],village_id:[null,f.required]}),this.userSubscription=this.userService.getUser().subscribe(c=>{if(c){this.user=c;let se={firstname:c.firstname||"",lastname:c.lastname||"",mobile:c.mobile||"",district_id:c.district_id||"",taluka_id:c.taluka_id||"",village_id:c.village_id||""};this.userForm.setValue(se),this.loadDistricts()}})}ngOnInit(){this.userForm.get("district_id")?.valueChanges.pipe(v(this.destroy$)).subscribe(e=>{this.userForm.get("taluka_id")?.markAsUntouched,this.userForm.get("village_id")?.markAsUntouched,this.selectedDistrict=this.districts.find(r=>r.id===e),this.talukas=[],this.villages=[],this.loadTalukas(),this.userForm.get("taluka_id")?.setValue(null)}),this.userForm.get("taluka_id")?.valueChanges.pipe(v(this.destroy$)).subscribe(e=>{this.userForm.get("village_id")?.markAsUntouched,this.selectedTaluka=this.talukas.find(r=>r.id===e),this.villages=[],this.loadVillages(),this.userForm.get("village_id")?.setValue(null)})}loadDistricts(){this.districtService.getDistrict().pipe(v(this.destroy$)).subscribe(e=>{this.districts=e,e.length&&(this.selectedDistrict=e.find(r=>r.id===this.user?.district_id),this.userForm.get("district_id")?.setValue(this.selectedDistrict?.id||null))})}loadTalukas(){let e=this.userForm.get("district_id")?.value;e&&this.talukaService.getTalukaByDistrict(e).pipe(v(this.destroy$)).subscribe(r=>{this.talukas=r,r.length&&(this.selectedTaluka=r.find(s=>s.id===this.user?.taluka_id),this.userForm.get("taluka_id")?.setValue(this.selectedTaluka?.id||null))})}loadVillages(){let e=this.userForm.get("taluka_id")?.value,r=this.userForm.get("district_id")?.value;e&&r&&this.villageService.getVillageByTaluka(e).pipe(v(this.destroy$)).subscribe(s=>{this.villages=s,s.length&&(this.selectedVillage=s.find(h=>h.id===this.user?.village_id),this.userForm.get("village_id")?.setValue(this.selectedVillage?.id||null))})}saveUser(){if(this.userForm.valid){if(this.user){let e=this.userForm.value;if(!Object.keys(e).some(d=>this.user[d]!==e[d])){this.toastService.show("User data has not changed. Skipping update.",{class:"bg-danger"});return}let s=this.user.id;if(!s){this.toastService.show("Invalid userid.",{class:"bg-danger"});return}this.userForm.setValue(e),this.userService.updateUserData(s,e).subscribe(d=>{this.userService.setUser(d.user),this.toastService.show(d.message,{class:"bg-success"}),this.userForm.setValue(e)},d=>{console.error("Error updating user:",d);let F=d&&typeof d.message=="string"?d.message:"Unexpected server response. Please check the network log.";this.toastService.show(F,{class:"bg-danger"})})}}else this.DS.markFormGroupTouched(this.userForm)}validateImage(e){return e||`https://dummyimage.com/300x300/F4F4F4/000000&text=${this.imageText()}`}imageText(){if(this.user&&this.user.firstname&&this.user.lastname){let e=this.user.firstname.charAt(0),r=this.user.lastname.charAt(0);return`${e}${r}`}else return"USER"}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(u(B),u(U),u(H),u(K),u(Q),u(ee),u(Z))}}static{this.\u0275cmp=C({type:t,selectors:[["app-edit-profile"]],decls:27,vars:10,consts:[[1,"h-100","w-100","position-md-absolute","overflow-auto","d-flex","flex-column"],[1,"card-header","d-flex","align-items-center"],[1,"m-0"],["routerLink","/user-profile/view",1,"btn","btn-danger","btn-sm","ms-auto"],[1,"fa","fa-close","me-2"],[1,"card-body","flex-grow-1","position-relative","p-0"],[1,"h-100","w-100","p-3","position-md-absolute","start-0","top-0","overflow-auto"],[1,"row","g-3",3,"ngSubmit","formGroup"],["class","col-lg-3 col-md-4 col-sm-6",4,"ngIf"],[1,"col-6","col-lg-3"],["class","form-group mt-1",4,"ngIf"],[1,"row","gx-3","mt-3"],[1,"col-12"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-save","me-2"],[1,"col-lg-3","col-md-4","col-sm-6"],[1,"form-group","mt-1"],[1,"form-label"],["type","text","placeholder","","aria-label","First name","formControlName","firstname",1,"form-control"],["type","text","placeholder","","aria-label","Last name","formControlName","lastname",1,"form-control"],[1,"input-group"],[1,"input-group-text"],["type","text","placeholder","","aria-label","Phone number","formControlName","mobile",1,"form-control"],["for","district_id",1,"form-label"],["id","district_id","formControlName","district_id","selectDropdown","",1,"form-select",3,"options"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","taluka_id",1,"form-label"],["id","taluka_id","formControlName","taluka_id",1,"form-select"],["for","village_id",1,"form-label"],["id","village_id","formControlName","village_id",1,"form-select"]],template:function(r,s){r&1&&(o(0,"div",0)(1,"div",1)(2,"h5",2),l(3,"Edit Profile"),i(),o(4,"button",3),g(5,"i",4),l(6,"Cancel"),i()(),o(7,"div",5)(8,"div",6)(9,"form",7),x("ngSubmit",function(){return!1}),o(10,"pre"),l(11),I(12,"json"),i(),p(13,le,5,0,"div",8)(14,ae,5,0,"div",8)(15,ne,8,0,"div",8),o(16,"div",9),p(17,me,7,2,"div",10),i(),o(18,"div",9),p(19,ue,7,1,"div",10),i(),o(20,"div",9),p(21,fe,7,1,"div",10),i()(),o(22,"div",11)(23,"div",12)(24,"button",13),x("click",function(){return s.saveUser()}),g(25,"i",14),l(26,"Save"),i()()()()()()),r&2&&(a(9),n("formGroup",s.userForm),a(2),_(T(12,8,s.user)),a(2),n("ngIf",s.userForm.get("firstname")!==null),a(),n("ngIf",s.userForm.get("lastname")!==null),a(),n("ngIf",s.userForm.get("mobile")!==null),a(2),n("ngIf",s.userForm.get("district_id")),a(2),n("ngIf",s.userForm.get("taluka_id")),a(2),n("ngIf",s.userForm.get("village_id")))},dependencies:[P,D,w,O,G,L,M,R,$,j,A,q,Y,z,N]})}}return t})();var he=[{path:"",component:ie,data:{title:"Edit Profile - Your Website",description:"Edit your profile details including name, mobile, and location.",keywords:"edit profile, user settings, update user details",robots:"index, follow",image:"/assets/edit-profile-image.png",canonical:"https://gujarat-uvach.netlify.app/edit-profile",breadcrumb:"Edit Profile"}}],re=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=b({imports:[k.forChild(he),k]})}}return t})();var qe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=b({imports:[V,re,W,J,X]})}}return t})();export{qe as EditProfileModule};
