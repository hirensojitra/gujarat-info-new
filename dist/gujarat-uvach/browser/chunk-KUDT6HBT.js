import{a as I}from"./chunk-FGPRL24T.js";import"./chunk-M63T62QT.js";import{a as x}from"./chunk-2S7OECMZ.js";import{a as y}from"./chunk-XSXBVDCX.js";import{a as A}from"./chunk-3PIGAWKT.js";import"./chunk-6TAJW53V.js";import{y as j,z as k}from"./chunk-OVKDPXDD.js";import{t as C,u as S,w as s}from"./chunk-KKCOZWDK.js";import{Jb as l,Kb as h,Lb as m,M as u,Qb as w,ac as p,bc as M,fb as d,gb as r,ha as a,id as b,ra as f,sa as c,t as g,zb as v}from"./chunk-PXJRLMEI.js";import"./chunk-CWTPBX7D.js";var G=(()=>{class e{constructor(i,o,t,n,R){this.router=i,this.registerService=o,this.authService=t,this.toast=n,this.cookie=R,this.isLoading=!1,this.errorMessage="",this.showSetPassword=!1,this.googleUserId="",this.newPassword="",this.confirmPassword=""}handleGoogleCredential(i){console.log("Google response:",i);try{let o=i.credential;this.isLoading=!0,this.errorMessage="",this.registerService.googleAuth(o).pipe(u(t=>(this.isLoading=!1,this.toast.show(t.message||"Google auth failed",{class:"bg-danger"}),g(null)))).subscribe(t=>{if(this.isLoading=!1,!!t&&t.token){let n={path:"/",secure:window.location.protocol==="https:",sameSite:"Lax"};this.authService.saveSession(t.token,t.user),t.requiresPassword?(this.cookie.set("requires_password",String(t.requiresPassword),n),this.cookie.set("google_user_id",t.user.id,n),this.router.navigate(["/authentication-action/set-password"])):this.router.navigate(["/home"])}})}catch(o){console.error("handleGoogleCredential error:",o),this.toast.show("Internal error processing Google response",{class:"bg-danger"}),this.isLoading=!1}}registerWithGoogle(){this.isLoading=!0,google.accounts.id.initialize({client_id:"650577899089-abc77o2gr9jldf1sfi6rcg6gptcdq4p8.apps.googleusercontent.com",callback:i=>this.handleGoogleCredential(i)}),google.accounts.id.prompt(i=>{})}static{this.\u0275fac=function(o){return new(o||e)(r(S),r(I),r(x),r(A),r(y))}}static{this.\u0275cmp=f({type:e,selectors:[["app-authentication"]],decls:12,vars:2,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100","flex-column"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],["src","assets/images/svg/logo-large.svg","alt","logo",1,"w-66-p","mx-auto","mb-3"],[1,"or-container"],[1,"text-center"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","btn-outline-danger","border","w-100","me-2",3,"click","disabled"],[1,"fa","fa-google","me-3"]],template:function(o,t){o&1&&(l(0,"div",0)(1,"div",1),m(2,"img",2)(3,"hr")(4,"router-outlet")(5,"span",3),l(6,"p",4),p(7,"Connect with us by"),h(),l(8,"div",5)(9,"button",6),w("click",function(){return t.registerWithGoogle()}),m(10,"i",7),p(11),h()()()()),o&2&&(d(9),v("disabled",t.isLoading),d(2),M(t.isLoading?"Google Signing In ...":"Google"))},dependencies:[C]})}}return e})();var N=[{path:"",component:G,data:{title:"PostNew | Authentication",description:"Login or register to PostNew portal for accessing services",keywords:"PostNew, login, register, authentication, portal",robots:"index, follow"},children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadChildren:()=>import("./chunk-IVQ6B4FW.js").then(e=>e.LoginModule)},{path:"register",loadChildren:()=>import("./chunk-GY7AU3SD.js").then(e=>e.RegisterModule)},{path:"forgot-password",loadChildren:()=>import("./chunk-SMD75S7Z.js").then(e=>e.ForgotPasswordModule)},{path:"reset-password",loadChildren:()=>import("./chunk-UI2URTJP.js").then(e=>e.ResetPasswordModule)},{path:"verify-email",loadChildren:()=>import("./chunk-GFE6PD5G.js").then(e=>e.VerifyEmailModule)}]}],P=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=c({type:e})}static{this.\u0275inj=a({imports:[s.forChild(N),s]})}}return e})();var X=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=c({type:e})}static{this.\u0275inj=a({imports:[b,s,P,j,k]})}}return e})();export{X as AuthenticationModule};
