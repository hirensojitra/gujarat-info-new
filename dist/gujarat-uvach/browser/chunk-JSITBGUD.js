import{a as N}from"./chunk-FROUF5SN.js";import{N as q,e as B}from"./chunk-E3XRSMLB.js";import{a as U}from"./chunk-P2Y25467.js";import"./chunk-S6FKRGRX.js";import"./chunk-VWVYJ5NX.js";import"./chunk-E7GWMVA6.js";import"./chunk-WVD7KDO5.js";import{r as j,t as D,u as O,v as I}from"./chunk-BWZ6RO2W.js";import{Ab as P,Ac as R,Cc as A,Da as k,Jb as M,Ma as r,Na as _,Z as v,ab as f,cb as a,f as y,ha as C,ia as x,ib as o,jb as s,kb as b,lb as S,mb as T,nb as h,ob as p,pb as c,qa as g,ra as d,rc as V,sa as w,sc as E,ta as L,tc as F,yb as l}from"./chunk-UQPPIRHC.js";var z=(e,m)=>({"btn-outline-dark":e,"btn-outline-primary active":m});function J(e,m){if(e&1){let t=h();o(0,"a",26),p("click",function(){g(t);let n=c().$implicit;return c(3).navigateToEdit(n.id),d(!1)}),b(1,"i",27),l(2,"Edit "),s()}}function K(e,m){if(e&1){let t=h();o(0,"div",17)(1,"div",18),w(),o(2,"svg",19),p("backgroundLoaded",function(){g(t);let n=c(3);return d(n.onSvgLoad())}),s(),L(),o(3,"div",20),f(4,J,3,0,"a",21),o(5,"a",22),b(6,"i",23),l(7,"View "),s()(),o(8,"span",24),l(9),o(10,"span",25),l(11,"unread messages"),s()()()()}if(e&2){let t=m.$implicit,i=c(3);r(2),a("postDataSet",t)("loadOnly",!0),r(2),a("ngIf",i.isAdmin()),r(),a("routerLink","/poster/"+t.id),r(4),P(" Download: ",t.download_counter," ")}}function Q(e,m){if(e&1){let t=h();o(0,"button",28),p("click",function(){let n=g(t).$implicit,u=c(3);return d(u.onPageChange(n))}),l(1),s()}if(e&2){let t=m.$implicit,i=c(3);a("ngClass",M(2,z,t!==i.currentPage,t===i.currentPage)),r(),P(" ",t," ")}}function W(e,m){if(e&1){let t=h();S(0),o(1,"div",10)(2,"div",11),f(3,K,12,5,"div",12),s()(),o(4,"div",13)(5,"div",14)(6,"button",15),p("click",function(){g(t);let n=c(2);return d(n.onPageChange(1))}),l(7,"First"),s(),o(8,"button",15),p("click",function(){g(t);let n=c(2);return d(n.onPageChange(n.currentPage-1))}),l(9,"Previous"),s(),f(10,Q,2,5,"button",16),o(11,"button",15),p("click",function(){g(t);let n=c(2);return d(n.onPageChange(n.currentPage+1))}),l(12,"Next"),s(),o(13,"button",15),p("click",function(){g(t);let n=c(2);return d(n.onPageChange(n.totalPages))}),l(14,"Last"),s()()(),T()}if(e&2){let t=c(2);r(3),a("ngForOf",t.posts),r(3),a("disabled",t.currentPage===1),r(2),a("disabled",t.currentPage===1),r(2),a("ngForOf",t.getPaginationControls()),r(),a("disabled",t.currentPage===t.totalPages),r(2),a("disabled",t.currentPage===t.totalPages)}}function X(e,m){if(e&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"button",7),b(7,"i",8),l(8,"Image"),s()(),f(9,W,15,6,"ng-container",9),s()()()()()),e&2){let t=c();r(6),a("routerLink","/images/generate"),r(3),a("ngIf",t.posts.length)}}var G=(()=>{class e{constructor(t,i,n,u,Y){this.PS=t,this.route=i,this.router=n,this.authService=u,this.platformId=Y,this.posts=[],this.imageUrls=[],this.currentPage=1,this.totalPages=0,this.totalLength=0,this.isBrowser=A(this.platformId)}ngOnInit(){return y(this,null,function*(){if(this.isBrowser){let t=yield import("./chunk-HRU3MFCF.js")}this.route.queryParams.subscribe(t=>{this.currentPage=+t.page||1,this.getAllPosts(),this.getTotalPostLength()})})}ngAfterViewInit(){setTimeout(()=>{if(this.isBrowser){let t=document.getElementById("masonry-grid");this.masonryInstance=new Masonry(t,{itemSelector:".masonry-box",percentPosition:!0})}},1500)}getAllPosts(){this.PS.getAllPosts(this.currentPage).subscribe(t=>{this.posts=t,this.generateImageUrls()})}generateImageUrls(){this.imageUrls=this.posts.map(()=>this.getRandomImage(1080,1920))}getTotalPostLength(){this.PS.getTotalPostLength().subscribe(t=>{this.totalLength=t.totalLength,this.calculateTotalPages()})}calculateTotalPages(){this.totalPages=Math.ceil(this.totalLength/12)}onPageChange(t){this.currentPage!==t&&(this.currentPage=t,this.updateUrlParams())}getPaginationControls(){return Array.from({length:this.totalPages},(t,i)=>i+1)}updateUrlParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{page:this.currentPage},queryParamsHandling:"merge"})}isAdmin(){return this.authService.hasRole(["admin","master"])}getRandomImage(t,i){return"https://dummyimage.com/"+(Math.floor(Math.random()*(i-t+1))+t)+"x"+(Math.floor(Math.random()*(i-t+1))+t)+"/F5F5F5/000"}onSvgLoad(){this.masonryInstance&&this.masonryInstance.layout()}navigateToEdit(t){let i={queryParams:{img:t}},n=this.router.createUrlTree(["/images/generate"],i),u=this.router.serializeUrl(n);window.open(u,"_blank")}static{this.\u0275fac=function(i){return new(i||e)(_(N),_(j),_(D),_(U),_(k))}}static{this.\u0275cmp=C({type:e,selectors:[["app-image-list"]],decls:1,vars:1,consts:[["class","h-100 d-flex flex-column p-3",4,"ngIf"],[1,"h-100","d-flex","flex-column","p-3"],[1,"flex-grow-1","position-relative","overflow-hidden"],[1,"position-absolute","h-100","w-100","d-flex","overflow-auto","flex-column"],[1,"container","h-100","w-100"],[1,"row","g-3"],[1,"col-12","pb-3"],["target","_blank","type","button",1,"btn","btn-success",3,"routerLink"],[1,"fa","fa-plus","me-2"],[4,"ngIf"],[1,"col-12","px-3"],["data-masonry","{'percentPosition': true }","id","masonry-grid",1,"row","g-3"],["class","col-lg-2 col-md-3 col-sm-4 col-6 masonry-box",4,"ngFor","ngForOf"],[1,"col-12"],[1,"btn-group","btn-group-toggle","py-3"],[1,"btn","btn-outline-dark",3,"click","disabled"],["class","btn",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col-lg-2","col-md-3","col-sm-4","col-6","masonry-box"],[1,"position-relative","border"],["preserveAspectRatio","xMidYMid meet","svgDraw","",1,"svg-content","max-w-100-p","max-h-100-p","img-fluid","m-auto","d-block",3,"backgroundLoaded","postDataSet","loadOnly"],["role","group",1,"btn-group","w-100"],["class","btn btn-secondary btn-sm rounded-0","target","_blank",3,"click",4,"ngIf"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0",3,"routerLink"],[1,"fa","fa-eye","me-2"],[1,"position-absolute","top-0","start-50","translate-middle","badge","rounded-pill","bg-danger"],[1,"visually-hidden"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0",3,"click"],[1,"fa","fa-edit","me-2"],[1,"btn",3,"click","ngClass"]],template:function(i,n){i&1&&f(0,X,10,2,"div",0),i&2&&a("ngIf",n.isBrowser)},dependencies:[V,E,F,O,B]})}}return e})();var Z=[{path:"",component:G,data:{title:"Image List",breadcrumb:"Image List",description:"Your Page Description"}}],H=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=x({type:e})}static{this.\u0275inj=v({imports:[I.forChild(Z),I]})}}return e})();var xt=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=x({type:e})}static{this.\u0275inj=v({imports:[R,H,q]})}}return e})();export{xt as ImageListModule};
