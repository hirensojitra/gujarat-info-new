import{a as H}from"./chunk-MHLMN6HZ.js";import{B as ie,O as ne,b as Y,f as J,h as K,j as X,n as Z,w as $,x as ee,y as te}from"./chunk-SM3E4O5B.js";import{a as U}from"./chunk-PSLVHKNI.js";import"./chunk-S2AHCA5Z.js";import"./chunk-CBCLPHDX.js";import{a as Q}from"./chunk-IHGCADJY.js";import"./chunk-WVD7KDO5.js";import{Aa as a,Da as B,E as v,Ea as k,Fa as D,Ha as d,Hb as W,J as M,Ja as R,Jb as G,K as y,Kb as q,La as I,Lb as P,Ma as C,Na as S,P as l,Q as m,Qa as z,R as b,S as L,X as V,_a as A,aa as c,ba as p,fb as F,gb as j,la as _,na as g,nb as N,ob as O,ta as o,ua as s,va as x,wa as T,xa as E,ya as w,za as u}from"./chunk-VTNAYE3H.js";import{f as h}from"./chunk-CWTPBX7D.js";var me=["masonryGrid"],de=()=>[12,24,48];function ge(n,f){if(n&1){let e=w();o(0,"a",31),u("click",function(){l(e);let t=a().$implicit;return a(3).navigateToEdit(t.id),m(!1)}),x(1,"i",32),d(2,"Edit "),s()}}function pe(n,f){if(n&1){let e=w();o(0,"div",22)(1,"div",23),b(),o(2,"svg",24),u("backgroundLoaded",function(){l(e);let t=a(3);return m(t.onSvgLoad())}),s(),L(),o(3,"div",25),_(4,ge,3,0,"a",26),o(5,"a",27),x(6,"i",28),d(7,"View "),s()(),o(8,"span",29),d(9),o(10,"span",30),d(11,"unread messages"),s()()()()}if(n&2){let e=f.$implicit,i=a(3);c(2),g("postDataSet",e)("loadOnly",!0),c(2),g("ngIf",i.isAdmin()),c(),g("routerLink","/poster/"+e.id),c(4),R(" Download: ",e.download_counter," ")}}function ue(n,f){if(n&1&&(T(0),o(1,"div",19)(2,"div",20,0),_(4,pe,12,5,"div",21),s()(),E()),n&2){let e=a(2);c(4),g("ngForOf",e.posts)}}function he(n,f){if(n&1){let e=w();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"button",8),x(7,"i",9),d(8,"Image"),s()(),o(9,"div",7)(10,"div",10)(11,"input",11),S("ngModelChange",function(t){l(e);let r=a();return C(r.search,t)||(r.search=t),m(t)}),u("input",function(){l(e);let t=a();return m(t.changePage(1))}),s(),o(12,"select",12),S("ngModelChange",function(t){l(e);let r=a();return C(r.sortBy,t)||(r.sortBy=t),m(t)}),u("change",function(){l(e);let t=a();return m(t.changePage(1))}),o(13,"option",13),d(14,"Date Created"),s(),o(15,"option",14),d(16,"Title"),s()(),o(17,"select",12),S("ngModelChange",function(t){l(e);let r=a();return C(r.order,t)||(r.order=t),m(t)}),u("change",function(){l(e);let t=a();return m(t.changePage(1))}),o(18,"option",15),d(19,"Ascending"),s(),o(20,"option",16),d(21,"Descending"),s()()()(),_(22,ue,5,1,"ng-container",17),s(),o(23,"div",18),u("currentPageChange",function(t){l(e);let r=a();return m(r.changePage(t))})("pageSizeChange",function(t){l(e);let r=a();return m(r.changePageSize(t))}),s()()()()()}if(n&2){let e=a();c(6),g("routerLink","/images/generate"),c(5),I("ngModel",e.search),c(),I("ngModel",e.sortBy),c(5),I("ngModel",e.order),c(5),g("ngIf",e.posts.length),c(),g("currentPage",e.currentPage)("totalItems",e.pagination.totalPosts)("pageSize",e.limit)("pageSizes",z(9,de))}}var oe=(()=>{class n{constructor(e,i,t,r,se,ce,le){this.PS=e,this.route=i,this.router=t,this.authService=r,this.platformId=se,this.cdr=ce,this.platformService=le,this.posts=[],this.currentPage=1,this.limit=12,this.search="",this.sortBy="created_at",this.order="desc",this.pagination={totalPosts:0,currentPage:1,totalPages:0},this.isBrowser=O(this.platformId)}ngOnInit(){return h(this,null,function*(){this.route.queryParams.subscribe(e=>h(this,null,function*(){this.currentPage=+e.page||1,this.limit=+e.limit||this.limit,this.search=e.search||this.search,this.sortBy=e.sortBy||this.sortBy,this.order=e.order||this.order,yield this.getAllPosts()}))})}ngAfterViewInit(){this.isBrowser&&(this.initializeMasonry(),window.addEventListener("resize",()=>{this.masonryInstance&&this.masonryInstance.layout()}))}initializeMasonry(){this.masonryGridRef&&this.isBrowser&&(console.log("Initializing Masonry:",this.masonryGridRef.nativeElement),this.masonryInstance=new Masonry(this.masonryGridRef.nativeElement,{itemSelector:".masonry-box",percentPosition:!0}))}loadDeviceId(){return h(this,null,function*(){this.isBrowser&&(this.deviceId=yield this.platformService.getDeviceId(),console.log("Device ID:",this.deviceId))})}getAllPosts(){return h(this,null,function*(){this.PS.getAllPosts({page:this.currentPage,limit:this.limit,search:this.search,sortBy:this.sortBy,order:this.order}).subscribe(e=>{this.posts=e.posts,this.pagination=e.pagination,this.cdr.detectChanges(),setTimeout(()=>{this.masonryInstance?(this.masonryInstance.reloadItems(),this.masonryInstance.layout()):this.initializeMasonry()},100)})})}changePage(e){this.currentPage!=e&&(this.currentPage=e,this.updateUrlParams(),this.getAllPosts())}changePageSize(e){this.limit!=e&&(this.limit=e,this.currentPage=1,this.updateUrlParams(),this.getAllPosts())}updateUrlParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{page:this.currentPage,limit:this.limit,search:this.search,sortBy:this.sortBy,order:this.order},queryParamsHandling:"merge"})}isAdmin(){return this.authService.hasRole(["admin","master"])}getRandomImage(e,i){return"https://dummyimage.com/"+(Math.floor(Math.random()*(i-e+1))+e)+"x"+(Math.floor(Math.random()*(i-e+1))+e)+"/F5F5F5/000"}onSvgLoad(){this.masonryInstance&&this.isBrowser&&window.dispatchEvent(new Event("resize"))}navigateToEdit(e){let i={queryParams:{img:e}},t=this.router.createUrlTree(["/images/generate"],i),r=this.router.serializeUrl(t);window.open(r,"_blank")}static{this.\u0275fac=function(i){return new(i||n)(p(H),p(W),p(G),p(U),p(V),p(A),p(Q))}}static{this.\u0275cmp=M({type:n,selectors:[["app-image-list"]],viewQuery:function(i,t){if(i&1&&B(me,5),i&2){let r;k(r=D())&&(t.masonryGridRef=r.first)}},decls:1,vars:1,consts:[["masonryGrid",""],["class","h-100 d-flex flex-column p-3",4,"ngIf"],[1,"h-100","d-flex","flex-column","p-3"],[1,"flex-grow-1","position-relative","overflow-hidden"],[1,"position-absolute","h-100","w-100","d-flex","overflow-auto","flex-column"],[1,"container","h-100","w-100"],[1,"row","g-3"],[1,"col-6","pb-3"],["target","_blank","type","button",1,"btn","btn-success",3,"routerLink"],[1,"fa","fa-plus","me-2"],[1,"search-sort-container"],["placeholder","Search posts",3,"ngModelChange","input","ngModel"],[3,"ngModelChange","change","ngModel"],["value","created_at"],["value","title"],["value","asc"],["value","desc"],[4,"ngIf"],["pagination","",1,"mt-0","mb-0","px-3",3,"currentPageChange","pageSizeChange","currentPage","totalItems","pageSize","pageSizes"],[1,"col-12","px-md-3","px-2"],["data-masonry","{'percentPosition': true}",1,"row","g-md-3","g-2"],["class","col-lg-2 col-md-3 col-sm-4 col-6 masonry-box",4,"ngFor","ngForOf"],[1,"col-lg-2","col-md-3","col-sm-4","col-6","masonry-box"],[1,"position-relative","border","p-1"],["preserveAspectRatio","xMidYMid meet","svgDraw","",1,"svg-content","max-w-100-p","max-h-100-p","img-fluid","d-block","m-1",3,"backgroundLoaded","postDataSet","loadOnly"],["role","group",1,"btn-group","w-100"],["class","btn btn-secondary btn-sm rounded-0 m-1","target","_blank",3,"click",4,"ngIf"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0","m-1",3,"routerLink"],[1,"fa","fa-eye","me-2"],[1,"position-absolute","top-0","start-50","translate-middle","badge","rounded-pill","bg-danger","d-none","d-md-block"],[1,"visually-hidden"],["target","_blank",1,"btn","btn-secondary","btn-sm","rounded-0","m-1",3,"click"],[1,"fa","fa-edit","me-2"]],template:function(i,t){i&1&&_(0,he,24,10,"div",1),i&2&&g("ngIf",t.isBrowser)},dependencies:[F,j,q,Y,J,ee,te,K,$,X,Z]})}}return n})();var _e=[{path:"",component:oe,data:{title:"Image List",breadcrumb:"Image List",description:"Your Page Description"}}],ae=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=v({imports:[P.forChild(_e),P]})}}return n})();var Oe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=v({imports:[N,ae,ne,ie]})}}return n})();export{Oe as ImageListModule};
