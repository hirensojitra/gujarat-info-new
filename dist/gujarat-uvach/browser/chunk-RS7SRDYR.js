import{a as l}from"./chunk-APHECYKI.js";import{fa as p,ka as d}from"./chunk-KKPMMK4Z.js";import{f as s}from"./chunk-CWTPBX7D.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function h(o){return decodeURIComponent(atob(o).replace(/(.)/g,(r,e)=>{let t=e.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}function k(o){let r=o.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return h(r)}catch{return atob(r)}}function a(o,r){if(typeof o!="string")throw new n("Invalid token specified: must be a string");r||(r={});let e=r.header===!0?0:1,t=o.split(".")[e];if(typeof t!="string")throw new n(`Invalid token specified: missing part #${e+1}`);let i;try{i=k(t)}catch(c){throw new n(`Invalid token specified: invalid base64 for part #${e+1} (${c.message})`)}try{return JSON.parse(i)}catch(c){throw new n(`Invalid token specified: invalid json for part #${e+1} (${c.message})`)}}var w=(()=>{class o{constructor(e){this.cookie=e}setToken(e){this.cookie.set("token",e,{path:"/",secure:window.location.protocol==="https:",sameSite:"Lax"})}getToken(){return this.cookie.get("token")}clearToken(){this.cookie.delete("token","/")}setOtp(e,t){let i={path:"/",secure:window.location.protocol==="https:",sameSite:"Lax"};this.cookie.set("email_otp_token",e,i),this.cookie.set("otp_expires_at",t,i)}removeOtpToken(){this.cookie.delete("email_otp_token","/")}getOtpToken(){return this.cookie.get("email_otp_token")}clearOtp(){this.cookie.delete("email_otp_token","/"),this.cookie.delete("otp_expires_at","/")}isLoggedIn(){return s(this,null,function*(){let e=this.getToken();if(!e)return!1;try{let t=a(e),i=Date.now()/1e3;return t.exp&&t.exp<i?(this.clearToken(),!1):!0}catch{return this.clearToken(),!1}})}isEmailVerified(){return s(this,null,function*(){let e=this.getToken();if(!e)return!1;try{return a(e).is_email_verified===!0}catch{return!1}})}static{this.\u0275fac=function(t){return new(t||o)(d(l))}}static{this.\u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{w as a};
