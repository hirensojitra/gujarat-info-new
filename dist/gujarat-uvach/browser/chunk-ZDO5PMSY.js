import{a as M}from"./chunk-EJW3GRWU.js";import"./chunk-B3LIIEQN.js";import{a as H}from"./chunk-L7P4BJVK.js";import{g as O,q as U}from"./chunk-NND4OT42.js";import{c as j,d as g,f as L,g as D,k as G,o as q,r as A,w as B,x as Y,y as z}from"./chunk-RYFY6OON.js";import"./chunk-A2ITBMAQ.js";import{a as N}from"./chunk-3VPX4MHT.js";import"./chunk-QHXDM6TZ.js";import{Aa as P,Ba as _,Ca as w,G as c,Ja as n,Jb as V,L as y,La as b,Lb as E,M as p,Mb as F,Nb as x,R as v,S as k,ca as a,da as m,f as S,ib as R,na as C,pa as d,pb as I,va as r,wa as s,xa as u,y as T,ya as f,za as h}from"./chunk-R3Y3IJJQ.js";function $(e,l){e&1&&(f(0),r(1,"p"),n(2,"Checking your reset token..."),s(),h())}function ee(e,l){e&1&&(f(0),r(1,"p"),n(2,"You can set your new password now."),s(),h())}function te(e,l){e&1&&(f(0),r(1,"p",10),n(2,"Your reset token has expired or is invalid."),s(),h())}function ie(e,l){if(e&1){let t=P();r(0,"form",11),_("ngSubmit",function(){v(t);let i=w();return k(i.onSubmit())}),r(1,"div",12)(2,"label",13),n(3,"New Password"),s(),u(4,"input",14),s(),r(5,"div",12)(6,"label",15),n(7,"Confirm New Password"),s(),u(8,"input",16),s(),r(9,"button",17),n(10),s()()}if(e&2){let t=w();d("formGroup",t.resetPasswordForm),a(9),d("disabled",t.isLoading||t.resetPasswordForm.invalid),a(),b(" ",t.isLoading?"Resetting...":"Reset Password"," ")}}function oe(e,l){if(e&1){let t=P();r(0,"div",8)(1,"button",18),_("click",function(){v(t);let i=w();return k(i.navigateToForgotPassword())}),n(2,"Go to Forgot Password"),s()()}}var K=(()=>{class e{constructor(t,o,i,W,X,Z){this.fb=t,this.route=o,this.router=i,this.authService=W,this.toast=X,this.platformService=Z,this.isLoading=!1,this.isTokenValid=!0,this.isTokenChecked=!1}ngOnInit(){this.token=this.route.snapshot.queryParams.token,this.email=this.route.snapshot.queryParams.email,this.resetPasswordForm=this.fb.group({password:["",[g.required,g.minLength(6)]],confirmPassword:["",[g.required]]},{validator:this.passwordsMatchValidator}),this.platformService.isBrowser()&&this.validateToken()}validateToken(){return S(this,null,function*(){yield this.authService.validateResetToken(this.token,this.email).pipe(T(()=>{this.isTokenChecked=!0})).subscribe(t=>{this.isTokenValid=t.success},t=>{this.toast.show(t,{class:"bg-danger"}),this.isTokenValid=!1})})}passwordsMatchValidator(t){return t.get("password").value===t.get("confirmPassword").value?null:{mismatch:!0}}onSubmit(){if(this.resetPasswordForm.invalid)return;this.isLoading=!0;let t=this.resetPasswordForm.get("password").value;this.authService.resetPassword(this.token,this.email,t).subscribe(o=>{this.isLoading=!1,this.toast.show("Password reset successfully",{class:"bg-success"}),this.router.navigate(["/login"])},o=>{this.isLoading=!1,o==="Token expired"?(this.toast.show("Reset token has expired. Please request a new one.",{class:"bg-danger"}),this.router.navigate(["/auth/forgot-password"])):this.toast.show("Error resetting password",{class:"bg-danger"})})}navigateToForgotPassword(){this.router.navigate(["/auth/forgot-password"])}static{this.\u0275fac=function(o){return new(o||e)(m(B),m(V),m(E),m(M),m(H),m(N))}}static{this.\u0275cmp=y({type:e,selectors:[["app-reset-password"]],decls:17,vars:7,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],[1,"text-center","mb-4"],["src","assets/images/svg/logo.svg","alt","logo",2,"width","60px"],[1,"mt-3"],[4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"text-center","mt-3"],[1,"text-decoration-none",3,"routerLink"],[1,"text-danger"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Enter new password",1,"form-control"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm new password",1,"form-control"],["type","submit",1,"btn","btn-dark","w-100",3,"disabled"],[1,"btn","btn-dark","w-100",3,"click"]],template:function(o,i){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),u(3,"img",3),r(4,"h4",4),n(5,"Reset Password"),s(),n(6),C(7,$,3,0,"ng-container",5)(8,ee,3,0,"ng-container",5)(9,te,3,0,"ng-container",5),s(),C(10,ie,11,3,"form",6)(11,oe,3,0,"div",7),r(12,"div",8)(13,"p"),n(14,"Don't have an account yet? "),r(15,"a",9),n(16,"Sign Up"),s()()()()()),o&2&&(a(6),b(" ",i.isTokenChecked+" -- "+i.isTokenValid," "),a(),d("ngIf",!i.isTokenChecked),a(),d("ngIf",i.isTokenChecked&&i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&!i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&!i.isTokenValid),a(4),d("routerLink","/auth/register"))},dependencies:[R,F,G,j,L,D,q,A,O]})}}return e})();var re=[{path:"",component:K,data:{title:"Reset Password",description:"Reset your password using email",keywords:"Forgot password, reset password",robots:"noindex, nofollow"}}],Q=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({imports:[x.forChild(re),x]})}}return e})();var Se=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({imports:[I,Q,Y,z,U]})}}return e})();export{Se as ResetPasswordModule};
