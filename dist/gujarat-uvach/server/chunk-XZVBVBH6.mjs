import './polyfills.server.mjs';
import{a as q}from"./chunk-QXYKVWSO.mjs";import"./chunk-WQAH27MK.mjs";import{a as U}from"./chunk-PQHBR4RA.mjs";import"./chunk-ZOSFQCFM.mjs";import{a as V}from"./chunk-SBPX72W3.mjs";import{c as j,f as G,j as D,y as W,z as F}from"./chunk-DXF4L3C7.mjs";import"./chunk-D7IAKCP3.mjs";import{A as h,w as R,y as T}from"./chunk-W6Z6YZO4.mjs";import{Aa as m,Ba as g,Bb as a,Lb as r,M as C,Mb as s,Nb as w,Ob as b,Pb as S,Qb as y,Sb as M,Ub as l,cc as d,ec as _,fd as N,gc as P,ha as u,hb as n,hc as I,ib as p,ic as L,od as E,ra as A,sa as f,t as x,zb as v}from"./chunk-MA44MDZG.mjs";import"./chunk-VVCT4QZE.mjs";function Y(t,k){if(t&1){let e=y();b(0),w(1,"router-outlet")(2,"span",4),r(3,"p",5),d(4,"Connect with us by"),s(),r(5,"div",6)(6,"button",7),M("click",function(){m(e);let i=l();return g(i.registerWithGoogle())}),w(7,"i",8),d(8),s()(),S()}if(t&2){let e=l();n(6),a("disabled",e.isLoading),n(2),_(" ",e.isLoading?"Loading...":"Google"," ")}}function H(t,k){if(t&1&&(r(0,"div",15),d(1),s()),t&2){let e=l(2);n(),_(" ",e.errorMessage," ")}}function J(t,k){if(t&1){let e=y();b(0),r(1,"h5",9),d(2,"Set Your Password"),s(),r(3,"div",10)(4,"label",11),d(5,"New Password"),s(),r(6,"input",12),L("ngModelChange",function(i){m(e);let c=l();return I(c.newPassword,i)||(c.newPassword=i),g(i)}),s()(),r(7,"div",10)(8,"label",11),d(9,"Confirm Password"),s(),r(10,"input",12),L("ngModelChange",function(i){m(e);let c=l();return I(c.confirmPassword,i)||(c.confirmPassword=i),g(i)}),s()(),v(11,H,2,1,"div",13),r(12,"button",14),M("click",function(){m(e);let i=l();return g(i.onSubmitNewPassword())}),d(13),s(),S()}if(t&2){let e=l();n(6),P("ngModel",e.newPassword),a("disabled",e.isLoading),n(4),P("ngModel",e.confirmPassword),a("disabled",e.isLoading),n(),a("ngIf",e.errorMessage),n(),a("disabled",e.isLoading),n(),_(" ",e.isLoading?"Saving...":"Save Password"," ")}}var z=(()=>{class t{constructor(e,o,i,c){this.router=e,this.registerService=o,this.authService=i,this.toast=c,this.isLoading=!1,this.errorMessage="",this.showSetPassword=!1,this.googleUserId="",this.newPassword="",this.confirmPassword=""}handleGoogleCredential(e){console.log("Google response:",e);try{let o=e.credential;this.isLoading=!0,this.errorMessage="",this.registerService.googleAuth(o).pipe(C(i=>(this.isLoading=!1,this.toast.show(i.message||"Google auth failed",{class:"bg-danger"}),x(null)))).subscribe(i=>{this.isLoading=!1,i&&(i.requiresPassword?(this.googleUserId=i.userId,this.showSetPassword=!0):i.token?(this.authService.setToken(i.token),this.router.navigate(["/home"])):this.toast.show("Unexpected response from Google auth",{class:"bg-warning"}))})}catch(o){console.error("handleGoogleCredential error:",o),this.toast.show("Internal error processing Google response",{class:"bg-danger"}),this.isLoading=!1}}registerWithGoogle(){this.isLoading=!0,google.accounts.id.initialize({client_id:"650577899089-abc77o2gr9jldf1sfi6rcg6gptcdq4p8.apps.googleusercontent.com",callback:e=>this.handleGoogleCredential(e)}),google.accounts.id.prompt(e=>{console.group("GSI Prompt Notification"),console.log("NotDisplayed?",e.isNotDisplayed(),e.getNotDisplayedReason()),console.log("Skipped?",e.isSkippedMoment(),e.getSkippedReason()),console.log("Dismissed?",e.isDismissedMoment(),e.getDismissedReason()),console.groupEnd()})}onSubmitNewPassword(){if(this.newPassword!==this.confirmPassword){this.errorMessage="Passwords do not match";return}this.isLoading=!0,this.registerService.setPassword(this.googleUserId,this.newPassword).pipe(C(e=>(this.isLoading=!1,this.toast.show(e.message||"Could not set password",{class:"bg-danger"}),x(null)))).subscribe(e=>{this.isLoading=!1,e?.token&&(this.authService.setToken(e.token),this.router.navigate(["/home"]))})}static{this.\u0275fac=function(o){return new(o||t)(p(T),p(q),p(V),p(U))}}static{this.\u0275cmp=A({type:t,selectors:[["app-authentication"]],decls:6,vars:2,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100","flex-column"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],["src","assets/images/svg/logo-large.svg","alt","logo",1,"w-66-p","mx-auto","mb-3"],[4,"ngIf"],[1,"or-container"],[1,"text-center"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","btn-outline-danger","border","w-100","me-2",3,"click","disabled"],[1,"fa","fa-google","me-3"],[1,"mb-3","text-center"],[1,"mb-3"],[1,"form-label"],["type","password",1,"form-control",3,"ngModelChange","ngModel","disabled"],["class","alert alert-danger py-1",4,"ngIf"],[1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"alert","alert-danger","py-1"]],template:function(o,i){o&1&&(r(0,"div",0)(1,"div",1),w(2,"img",2)(3,"hr"),v(4,Y,9,2,"ng-container",3)(5,J,14,7,"ng-container",3),s()()),o&2&&(n(4),a("ngIf",!i.showSetPassword),n(),a("ngIf",i.showSetPassword))},dependencies:[N,R,j,G,D]})}}return t})();var K=[{path:"",component:z,data:{title:"PostNew | Authentication",description:"Login or register to PostNew portal for accessing services",keywords:"PostNew, login, register, authentication, portal",robots:"index, follow"},children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadChildren:()=>import("./chunk-NVJGSHXO.mjs").then(t=>t.LoginModule)},{path:"register",loadChildren:()=>import("./chunk-IOT7MRCY.mjs").then(t=>t.RegisterModule)},{path:"forgot-password",loadChildren:()=>import("./chunk-ARLCDFSW.mjs").then(t=>t.ForgotPasswordModule)},{path:"reset-password",loadChildren:()=>import("./chunk-JEP5T4SJ.mjs").then(t=>t.ResetPasswordModule)},{path:"verify-email",loadChildren:()=>import("./chunk-UMHEVBEI.mjs").then(t=>t.VerifyEmailModule)}]}],O=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=f({type:t})}static{this.\u0275inj=u({imports:[h.forChild(K),h]})}}return t})();var pe=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=f({type:t})}static{this.\u0275inj=u({imports:[E,h,O,W,F]})}}return t})();export{pe as AuthenticationModule};
