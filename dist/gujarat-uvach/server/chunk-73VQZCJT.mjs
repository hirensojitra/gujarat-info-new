import './polyfills.server.mjs';
import{a as N}from"./chunk-HRTQ2G2J.mjs";import"./chunk-4PYPEGK6.mjs";import{a as J}from"./chunk-RIQUXMK6.mjs";import{d as U,r as H}from"./chunk-6NBIPZEG.mjs";import{c as L,d as v,f as D,g as G,k as q,o as A,r as B,w as Y,x as z,y as O}from"./chunk-X6RFGL5P.mjs";import{a as j}from"./chunk-CGEXYLQB.mjs";import"./chunk-ZOQGZUTB.mjs";import{Aa as r,Ba as s,Ca as f,Da as h,E as p,Ea as w,Fa as _,Ga as S,Gb as V,Ha as g,K as R,L as u,Oa as n,Q as k,Qa as b,R as C,ec as F,ha as a,hc as E,ia as m,ic as M,jc as T,m as x,sa as P,ua as d,w as y,zb as I}from"./chunk-YAE7DDPL.mjs";import{h as c}from"./chunk-VVCT4QZE.mjs";function ee(e,l){e&1&&(h(0),r(1,"p"),n(2,"Checking your reset token..."),s(),w())}function te(e,l){e&1&&(h(0),r(1,"p"),n(2,"You can set your new password now."),s(),w())}function ie(e,l){e&1&&(h(0),r(1,"p",8),n(2,"Your reset token has expired or is invalid."),s(),w())}function oe(e,l){if(e&1){let t=_();r(0,"form",9),S("ngSubmit",function(){k(t);let i=g();return C(i.onSubmit())}),r(1,"div",10)(2,"label",11),n(3,"New Password"),s(),f(4,"input",12),s(),r(5,"div",10)(6,"label",13),n(7,"Confirm New Password"),s(),f(8,"input",14),s(),r(9,"button",15),n(10),s()()}if(e&2){let t=g();d("formGroup",t.resetPasswordForm),a(9),d("disabled",t.isLoading||t.resetPasswordForm.invalid),a(),b(" ",t.isLoading?"Resetting...":"Reset Password"," ")}}function re(e,l){if(e&1){let t=_();r(0,"div",6)(1,"button",16),S("click",function(){k(t);let i=g();return C(i.navigateToForgotPassword())}),n(2,"Go to Forgot Password"),s()()}}var Q=(()=>{class e{constructor(t,o,i,X,Z,$){this.fb=t,this.route=o,this.router=i,this.authService=X,this.toast=Z,this.platformService=$,this.isLoading=!1,this.isTokenValid=!0,this.isTokenChecked=!1}ngOnInit(){return c(this,null,function*(){})}ngAfterViewInit(){return c(this,null,function*(){if(this.platformService.isBrowser()){debugger;this.token=this.route.snapshot.queryParams.token,this.email=this.route.snapshot.queryParams.email,yield this.validateToken(),this.resetPasswordForm=this.fb.group({password:["",[v.required,v.minLength(6)]],confirmPassword:["",[v.required]]},{validator:this.passwordsMatchValidator})}})}validateToken(){return c(this,null,function*(){try{let t=yield x(this.authService.validateResetToken(this.token,this.email).pipe(y(()=>this.isTokenChecked=!0)));this.isTokenValid=t.success}catch(t){this.toast.show(t,{class:"bg-danger"}),this.isTokenValid=!1}})}passwordsMatchValidator(t){return t.get("password").value===t.get("confirmPassword").value?null:{mismatch:!0}}onSubmit(){if(this.resetPasswordForm.invalid)return;this.isLoading=!0;let t=this.resetPasswordForm.get("password").value;this.authService.resetPassword(this.token,this.email,t).subscribe(o=>{this.isLoading=!1,this.toast.show("Password reset successfully",{class:"bg-success"}),this.router.navigate(["/login"])},o=>{this.isLoading=!1,o==="Token expired"?(this.toast.show("Reset token has expired. Please request a new one.",{class:"bg-danger"}),this.router.navigate(["/auth/forgot-password"])):this.toast.show("Error resetting password",{class:"bg-danger"})})}navigateToForgotPassword(){this.router.navigate(["/auth/forgot-password"])}static{this.\u0275fac=function(o){return new(o||e)(m(Y),m(F),m(E),m(N),m(J),m(j))}}static{this.\u0275cmp=R({type:e,selectors:[["app-reset-password"]],decls:15,vars:7,consts:[[1,"text-center","mb-4"],["src","assets/images/svg/logo.svg","alt","logo",2,"width","60px"],[1,"mt-3"],[4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"text-center","mt-3"],[1,"text-decoration-none",3,"routerLink"],[1,"text-danger"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Enter new password",1,"form-control"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm new password",1,"form-control"],["type","submit",1,"btn","btn-dark","w-100",3,"disabled"],[1,"btn","btn-dark","w-100",3,"click"]],template:function(o,i){o&1&&(r(0,"div",0),f(1,"img",1),r(2,"h4",2),n(3,"Reset Password"),s(),n(4),P(5,ee,3,0,"ng-container",3)(6,te,3,0,"ng-container",3)(7,ie,3,0,"ng-container",3),s(),P(8,oe,11,3,"form",4)(9,re,3,0,"div",5),r(10,"div",6)(11,"p"),n(12,"Don't have an account yet? "),r(13,"a",7),n(14,"Sign Up"),s()()()),o&2&&(a(4),b(" ",i.isTokenChecked+" -- "+i.isTokenValid," "),a(),d("ngIf",!i.isTokenChecked),a(),d("ngIf",i.isTokenChecked&&i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&!i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&i.isTokenValid),a(),d("ngIf",i.isTokenChecked&&!i.isTokenValid),a(4),d("routerLink","/auth/register"))},dependencies:[I,M,q,L,D,G,A,B,U]})}}return e})();var se=[{path:"",component:Q,data:{title:"Reset Password",description:"Reset your password using email",keywords:"Forgot password, reset password",robots:"noindex, nofollow"}}],W=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=u({type:e})}static{this.\u0275inj=p({imports:[T.forChild(se),T]})}}return e})();var xe=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=u({type:e})}static{this.\u0275inj=p({imports:[V,W,z,O,H]})}}return e})();export{xe as ResetPasswordModule};
