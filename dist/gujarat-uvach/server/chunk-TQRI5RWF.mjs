import './polyfills.server.mjs';
import{a as N}from"./chunk-JWFCZQML.mjs";import{a as R}from"./chunk-HRTQ2G2J.mjs";import"./chunk-4PYPEGK6.mjs";import{d as D,r as P}from"./chunk-6NBIPZEG.mjs";import{c as x,d as c,f as j,g as L,k as G,o as I,r as T,w as U,x as q,y as A}from"./chunk-X6RFGL5P.mjs";import"./chunk-CGEXYLQB.mjs";import{a as E}from"./chunk-ZOQGZUTB.mjs";import{Aa as o,Ba as r,Ca as l,E as h,Ga as v,Gb as M,K as y,L as b,Oa as s,Pb as F,Ya as S,ha as d,hc as w,ia as g,ic as _,jc as k,k as u,u as f,ua as p,xb as C}from"./chunk-YAE7DDPL.mjs";import"./chunk-VVCT4QZE.mjs";var W=i=>({"is-invalid":i}),O=(()=>{class i{constructor(e,n,t,a,m){this.fb=e,this.http=n,this.router=t,this.userService=a,this.authService=m,this.isLoading=!1,this.errorMessage="",this.api=E.MasterApi}ngOnInit(){this.registrationForm=this.fb.group({username:["",c.required],email:["",[c.required,c.email]],password:["",c.required],roles:["user"]})}handleGoogleCredential(e){let n=e.credential;console.log("Google idToken:",n),this.http.post(this.api+"/auth/google",{idToken:n},{responseType:"json"}).pipe(f(t=>(this.errorMessage=t.error?.message||"Google authentication failed.",this.isLoading=!1,u(null)))).subscribe(t=>{this.isLoading=!1,t&&t.token?(console.log(t),e.token&&(this.userService.setUser(e),this.authService.setToken(e.token),this.router.navigate(["/dashboard"])),localStorage.setItem("token",t.token),this.router.navigate(["/dashboard"])):this.errorMessage="Unable to process Google registration."})}register(){this.registrationForm.invalid||(this.isLoading=!0,this.errorMessage="",this.http.post("/api/auth/register",this.registrationForm.value).pipe(f(e=>(this.errorMessage=e.error?.message||"Registration failed.",this.isLoading=!1,console.log(this.errorMessage),u(null)))).subscribe(e=>{this.isLoading=!1,e&&e.success?this.router.navigate(["/auth/login"]):e&&e.error&&(this.errorMessage=e.error)}))}registerWithGoogle(){this.isLoading=!0,this.errorMessage="",google.accounts.id.initialize({client_id:"650577899089-eq5q93v869b5qvi6vllcq81o8v06ubsm.apps.googleusercontent.com",callback:e=>this.handleGoogleCredential(e)}),google.accounts.id.prompt()}registerWithFacebook(){this.isLoading=!0,this.errorMessage="",this.http.get(this.api+"/auth/facebook",{responseType:"json"}).pipe(f(e=>(this.errorMessage=e.error?.message||"Facebook registration failed.",this.isLoading=!1,u(null)))).subscribe(e=>{this.isLoading=!1,e&&e.redirectUrl?window.location.href=e.redirectUrl:this.errorMessage="Unable to process Facebook registration."})}static{this.\u0275fac=function(n){return new(n||i)(g(U),g(F),g(w),g(N),g(R))}}static{this.\u0275cmp=y({type:i,selectors:[["app-register"]],decls:39,vars:9,consts:[[1,"container","d-flex","align-items-center","justify-content-center","min-vh-100"],[1,"card","shadow","p-4",2,"width","400px","border-radius","15px"],[1,"text-center","mb-4"],["src","assets/images/svg/logo.svg","alt","logo",2,"width","60px"],[1,"mt-3"],[3,"ngSubmit","formGroup"],["type","hidden","formControlName","roles"],[1,"form-group","mb-3"],["for","username",1,"form-label"],["type","text","id","username","formControlName","username","placeholder","Enter your username",1,"form-control",3,"ngClass"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Enter your email",1,"form-control",3,"ngClass"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Password",1,"form-control"],["type","submit",1,"btn","btn-dark","w-100","mb-3",3,"disabled"],[1,"text-center","mb-3"],["type","button",1,"btn","btn-outline-danger","me-2",3,"click"],[1,"fab","fa-google"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fab","fa-facebook-f"],[1,"text-center"],[1,"text-decoration-none",3,"routerLink"],["id","googleSignInDiv"]],template:function(n,t){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),l(3,"img",3),o(4,"h4",4),s(5,"Create an account"),r(),o(6,"p"),s(7,"Please fill in the details to sign up."),r()(),o(8,"form",5),v("ngSubmit",function(){return t.register()}),l(9,"input",6),o(10,"div",7)(11,"label",8),s(12,"Username"),r(),l(13,"input",9),r(),o(14,"div",7)(15,"label",10),s(16,"E-Mail Address"),r(),l(17,"input",11),r(),o(18,"div",7)(19,"label",12),s(20,"Password"),r(),l(21,"input",13),r(),o(22,"button",14),s(23,"Sign Up"),r()(),o(24,"div",15)(25,"p"),s(26,"Or register with"),r(),o(27,"button",16),v("click",function(){return t.registerWithGoogle()}),l(28,"i",17),s(29," Google "),r(),o(30,"button",18),v("click",function(){return t.registerWithFacebook()}),l(31,"i",19),s(32," Facebook "),r()(),o(33,"div",20)(34,"p"),s(35,"Already have an account? "),o(36,"a",21),s(37,"Sign In"),r()()(),l(38,"div",22),r()()),n&2){let a,m;d(8),p("formGroup",t.registrationForm),d(5),p("ngClass",S(5,W,((a=t.registrationForm.get("username"))==null?null:a.invalid)&&((a=t.registrationForm.get("username"))==null?null:a.touched))),d(4),p("ngClass",S(7,W,((m=t.registrationForm.get("email"))==null?null:m.invalid)&&((m=t.registrationForm.get("email"))==null?null:m.touched))),d(5),p("disabled",t.registrationForm.invalid),d(14),p("routerLink","/auth/login")}},dependencies:[C,_,G,x,j,L,I,T,D]})}}return i})();var B=[{path:"",component:O,data:{title:"PostNew | Register",description:"Login or register to PostNew portal for accessing services",keywords:"PostNew, login, register, portal",robots:"index, follow",image:"https://test-ssr-hiren.netlify.app/assets/images/jpg/register.jpg"}}],z=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=b({type:i})}static{this.\u0275inj=h({imports:[k.forChild(B),k]})}}return i})();var ce=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=b({type:i})}static{this.\u0275inj=h({imports:[M,z,q,A,P]})}}return i})();export{ce as RegisterModule};
