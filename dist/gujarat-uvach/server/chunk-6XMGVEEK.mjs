import './polyfills.server.mjs';
import{a as k}from"./chunk-7HDQKCIK.mjs";import{a as p}from"./chunk-AJBY5M5H.mjs";import{ka as r,pa as c}from"./chunk-SNHROY6X.mjs";import{a as s,b as n}from"./chunk-VVCT4QZE.mjs";var l=(()=>{class i{constructor(e){this.cookie=e,this.cookieOptions={path:"/",secure:p.production,sameSite:"Strict",httpOnly:!1}}setToken(e,t=!1){let o=t?this.getFutureDate(30):void 0;this.cookie.set("token",e,n(s({},this.cookieOptions),{expires:o}))}getToken(){return this.cookie.get("token")||null}removeToken(){this.cookie.delete("token",this.cookieOptions.path)}setUser(e,t=!1){console.log("Setting user in cookie:",JSON.stringify(e));let o=t?this.getFutureDate(30):void 0;this.cookie.set("user",JSON.stringify(e),n(s({},this.cookieOptions),{expires:o}))}getUser(){let e=this.cookie.get("user");return console.log("Raw user JSON from cookie:",e),e?JSON.parse(e):null}removeUser(){this.cookie.delete("user",this.cookieOptions.path)}setOtpToken(e,t){let o=new Date(t);this.cookie.set("otp_token",e,n(s({},this.cookieOptions),{expires:o})),this.cookie.set("otp_expires_at",t,n(s({},this.cookieOptions),{expires:o}))}getOtpToken(){return this.cookie.get("otp_token")||null}removeOtpToken(){this.cookie.delete("otp_token",this.cookieOptions.path),this.cookie.delete("otp_expires_at",this.cookieOptions.path)}isLoggedIn(){return!!this.getToken()&&!!this.getUser()}isEmailVerified(){let e=this.getUser();return e?e.email_verified:!1}getFutureDate(e){let t=new Date;return t.setDate(t.getDate()+e),t}static{this.\u0275fac=function(t){return new(t||i)(c(k))}}static{this.\u0275prov=r({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{l as a};
