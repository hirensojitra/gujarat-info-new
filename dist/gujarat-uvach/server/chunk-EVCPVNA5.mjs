import './polyfills.server.mjs';
import{a as x}from"./chunk-BHXUZULZ.mjs";import{M as d,Ya as g,c as l,gb as k,kb as f,nb as I,p,s as u}from"./chunk-ZK6TCPG7.mjs";var U=(()=>{class s{constructor(e,t){this.document=e,this.platformId=t,this.documentIsAccessible=k(this.platformId)}static getCookieRegExp(e){let t=e.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+t+"|;\\s*"+t+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),s.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.documentIsAccessible&&this.check(e)){e=encodeURIComponent(e);let o=s.getCookieRegExp(e).exec(this.document.cookie);return o[1]?s.safeDecodeURIComponent(o[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},t=this.document;return t.cookie&&t.cookie!==""&&t.cookie.split(";").forEach(o=>{let[i,n]=o.split("=");e[s.safeDecodeURIComponent(i.replace(/^ /,""))]=s.safeDecodeURIComponent(n)}),e}set(e,t,o,i,n,a,m,b){if(!this.documentIsAccessible)return;if(typeof o=="number"||o instanceof Date||i||n||a||m){let h={expires:o,path:i,domain:n,secure:a,sameSite:m||"Lax",partitioned:b};this.set(e,t,h);return}let c=encodeURIComponent(e)+"="+encodeURIComponent(t)+";",r=o||{};if(r.expires)if(typeof r.expires=="number"){let h=new Date(new Date().getTime()+r.expires*1e3*60*60*24);c+="expires="+h.toUTCString()+";"}else c+="expires="+r.expires.toUTCString()+";";r.path&&(c+="path="+r.path+";"),r.domain&&(c+="domain="+r.domain+";"),r.secure===!1&&r.sameSite==="None"&&(r.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),r.secure&&(c+="secure;"),r.sameSite||(r.sameSite="Lax"),c+="sameSite="+r.sameSite+";",r.partitioned&&(c+="Partitioned;"),this.document.cookie=c}delete(e,t,o,i,n="Lax"){if(!this.documentIsAccessible)return;let a=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:a,path:t,domain:o,secure:i,sameSite:n})}deleteAll(e,t,o,i="Lax"){if(!this.documentIsAccessible)return;let n=this.getAll();for(let a in n)n.hasOwnProperty(a)&&this.delete(a,e,t,o,i)}static{this.\u0275fac=function(t){return new(t||s)(u(g),u(d))}}static{this.\u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var E=(()=>{class s{constructor(e,t){this.http=e,this.cookieService=t,this.userSubject=new l(null),this.apiUrl=x.MasterApi+"/auth";let o=this.cookieService.get("user");if(o)try{let i=JSON.parse(o);this.userSubject.next(i)}catch(i){console.error("Error parsing stored user:",i),this.cookieService.delete("user")}}getUser(){return this.userSubject.asObservable()}getFullName(){let e=this.userSubject.value;if(e){let t=e.firstname||"",o=e.lastname||"";return`${t} ${o}`.trim()}return""}setUser(e){this.cookieService.set("user",JSON.stringify(e),{path:"/",secure:!1}),this.userSubject.next(e)}updateUserData(e,t){let o=this.cookieService.get("token"),i=new f({Authorization:`Bearer ${o}`}),n=`${this.apiUrl}/updateUser/${e}`;return this.http.put(n,t,{headers:i})}verifyEmail(e,t){let o=new f({Authorization:`Bearer ${this.cookieService.get("token")}`});return this.http.get(`${this.apiUrl}/verify-email?token=${encodeURIComponent(e)}&email=${encodeURIComponent(t)}`,{headers:o})}registerUser(e,t,o,i,n){return this.http.post(`${this.apiUrl}/register`,{username:e,password:t,email:o,roles:i,emailVerified:n})}static{this.\u0275fac=function(t){return new(t||s)(u(I),u(U))}}static{this.\u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{U as a,E as b};
