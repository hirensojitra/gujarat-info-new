import './polyfills.server.mjs';
import{a as U}from"./chunk-CAKG2HOS.mjs";import"./chunk-UPMEHPE4.mjs";import"./chunk-3VBPSQSZ.mjs";import{a as N}from"./chunk-NU7POH55.mjs";import{N as q,e as B}from"./chunk-VCRITVTQ.mjs";import"./chunk-SMRXC6H5.mjs";import"./chunk-Z6IJNFE7.mjs";import{u as j,x as D,y as O,z as y}from"./chunk-6WLKSXTS.mjs";import{Ac as R,Cc as A,Fb as M,Ia as r,Ja as _,T as v,Ya as f,_a as a,ba as C,ca as x,eb as o,fb as s,gb as b,hb as S,ib as T,jb as h,ka as m,kb as d,la as g,lb as c,ma as w,na as L,rc as V,sc as E,tc as F,ub as l,wb as P,xa as k}from"./chunk-34FBJKO2.mjs";import{h as I}from"./chunk-VVCT4QZE.mjs";var z=(i,p)=>({"btn-outline-dark":i,"btn-outline-primary active":p});function J(i,p){if(i&1){let t=h();o(0,"a",26),d("click",function(){m(t);let n=c().$implicit;return c(2).navigateToEdit(n.id),g(!1)})("click",function(){return m(t),g(!1)}),b(1,"i",27),l(2,"Edit"),s()}}function K(i,p){if(i&1){let t=h();o(0,"div",16)(1,"div",17),w(),o(2,"svg",18),d("backgroundLoaded",function(){m(t);let n=c(2);return g(n.onSvgLoad())}),s(),L(),o(3,"div",19)(4,"div",20),f(5,J,3,0,"a",21),o(6,"a",22),b(7,"i",23),l(8,"View"),s()()(),o(9,"span",24),l(10),o(11,"span",25),l(12,"unread messages"),s()()()()}if(i&2){let t=p.$implicit,e=c(2);r(2),a("postDataSet",t)("loadOnly",!0),r(3),a("ngIf",e.isAdmin()),r(),a("routerLink","/poster/"+t.id),r(4),P(" ",t.download_counter," ")}}function Q(i,p){if(i&1){let t=h();o(0,"button",28),d("click",function(){let n=m(t).$implicit,u=c(2);return g(u.onPageChange(n))}),l(1),s()}if(i&2){let t=p.$implicit,e=c(2);a("ngClass",M(2,z,t!==e.currentPage,t===e.currentPage)),r(),P(" ",t," ")}}function W(i,p){if(i&1){let t=h();S(0),o(1,"div",9)(2,"div",10),f(3,K,13,5,"div",11),s()(),o(4,"div",12)(5,"div",13)(6,"button",14),d("click",function(){m(t);let n=c();return g(n.onPageChange(1))}),l(7,"First"),s(),o(8,"button",14),d("click",function(){m(t);let n=c();return g(n.onPageChange(n.currentPage-1))}),l(9,"Previous"),s(),f(10,Q,2,5,"button",15),o(11,"button",14),d("click",function(){m(t);let n=c();return g(n.onPageChange(n.currentPage+1))}),l(12,"Next"),s(),o(13,"button",14),d("click",function(){m(t);let n=c();return g(n.onPageChange(n.totalPages))}),l(14,"Last"),s()()(),T()}if(i&2){let t=c();r(3),a("ngForOf",t.posts),r(3),a("disabled",t.currentPage===1),r(2),a("disabled",t.currentPage===1),r(2),a("ngForOf",t.getPaginationControls()),r(),a("disabled",t.currentPage===t.totalPages),r(2),a("disabled",t.currentPage===t.totalPages)}}var G=(()=>{class i{constructor(t,e,n,u,Y){this.PS=t,this.route=e,this.router=n,this.authService=u,this.platformId=Y,this.posts=[],this.imageUrls=[],this.currentPage=1,this.totalPages=0,this.totalLength=0,this.isBrowser=A(this.platformId)}ngOnInit(){return I(this,null,function*(){if(this.isBrowser){let t=yield import("./chunk-RY3HQQVQ.mjs")}this.route.queryParams.subscribe(t=>{this.currentPage=+t.page||1,this.getAllPosts(),this.getTotalPostLength()})})}ngAfterViewInit(){setTimeout(()=>{if(this.isBrowser){let t=document.getElementById("masonry-grid");this.masonryInstance=new Masonry(t,{itemSelector:".masonry-box",percentPosition:!0})}},1500)}getAllPosts(){this.PS.getAllPosts(this.currentPage).subscribe(t=>{this.posts=t,this.generateImageUrls()})}generateImageUrls(){this.imageUrls=this.posts.map(()=>this.getRandomImage(1080,1920))}getTotalPostLength(){this.PS.getTotalPostLength().subscribe(t=>{this.totalLength=t.totalLength,this.calculateTotalPages()})}calculateTotalPages(){this.totalPages=Math.ceil(this.totalLength/12)}onPageChange(t){this.currentPage!==t&&(this.currentPage=t,this.updateUrlParams())}getPaginationControls(){return Array.from({length:this.totalPages},(t,e)=>e+1)}updateUrlParams(){this.router.navigate([],{relativeTo:this.route,queryParams:{page:this.currentPage},queryParamsHandling:"merge"})}isAdmin(){return this.authService.hasRole(["admin","master"])}getRandomImage(t,e){return"https://dummyimage.com/"+(Math.floor(Math.random()*(e-t+1))+t)+"x"+(Math.floor(Math.random()*(e-t+1))+t)+"/F5F5F5/000"}onSvgLoad(){this.masonryInstance&&this.masonryInstance.layout()}navigateToEdit(t){let e={queryParams:{img:t}},n=this.router.createUrlTree(["/images/generate"],e),u=this.router.serializeUrl(n);window.open(u,"_blank")}static{this.\u0275fac=function(e){return new(e||i)(_(N),_(j),_(D),_(U),_(k))}}static{this.\u0275cmp=C({type:i,selectors:[["app-image-list"]],decls:10,vars:2,consts:[[1,"h-100","d-flex","flex-column","p-3"],[1,"flex-grow-1","position-relative","overflow-hidden"],[1,"position-absolute","h-100","w-100","d-flex","overflow-auto","flex-column"],[1,"container","h-100","w-100"],[1,"row","g-3"],[1,"col-12","pb-3"],["target","_blank","type","button",1,"btn","btn-success",3,"routerLink"],[1,"fa","fa-plus","me-2"],[4,"ngIf"],[1,"col-12","px-3"],["data-masonry","{'percentPosition': true }","id","masonry-grid",1,"row","g-3"],["class","col-lg-2 col-md-3 col-sm-4 col-6 masonry-box",4,"ngFor","ngForOf"],[1,"col-12"],[1,"btn-group","btn-group-toggle","py-3"],[1,"btn","btn-outline-dark",3,"click","disabled"],["class","btn",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col-lg-2","col-md-3","col-sm-4","col-6","masonry-box"],[1,"position-relative"],["preserveAspectRatio","xMidYMid meet","svgDraw","",1,"svg-content","max-w-100-p","max-h-100-p","img-fluid","m-auto","d-block",3,"backgroundLoaded","postDataSet","loadOnly"],[1,"d-flex","flex-column","position-absolute","start-0","top-0","h-100","w-100","p-3"],[1,"d-flex","mb-auto"],["class","btn btn-secondary btn-sm me-auto","target","_blank",3,"click",4,"ngIf"],["target","_blank",1,"btn","btn-secondary","btn-sm","ms-auto",3,"routerLink"],[1,"fa","fa-eye"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-danger"],[1,"visually-hidden"],["target","_blank",1,"btn","btn-secondary","btn-sm","me-auto",3,"click"],[1,"fa","fa-edit"],[1,"btn",3,"click","ngClass"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),b(7,"i",7),l(8,"Image"),s()(),f(9,W,15,6,"ng-container",8),s()()()()()),e&2&&(r(6),a("routerLink","/images/generate"),r(3),a("ngIf",n.posts.length))},dependencies:[V,E,F,O,B]})}}return i})();var X=[{path:"",component:G,data:{title:"Image List",breadcrumb:"Image List",description:"Your Page Description"}}],H=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=x({type:i})}static{this.\u0275inj=v({imports:[y.forChild(X),y]})}}return i})();var vt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=x({type:i})}static{this.\u0275inj=v({imports:[R,H,q]})}}return i})();export{vt as ImageListModule};
