<div class="app-container h-screen flex flex-col" [class.dark]="isDarkTheme">
  <!-- Header -->
  <mat-toolbar class="app-header">
    <div class="flex items-center justify-between w-full">
      <div class="header-title">
        <mat-icon>palette</mat-icon>
        <span class="title-text">Poster Generator</span>
      </div>

      <div class="header-actions">
        <button 
          mat-icon-button 
          (click)="toggleTheme()"
          matTooltip="Toggle Theme">
          <mat-icon>{{ isDarkTheme ? 'light_mode' : 'dark_mode' }}</mat-icon>
        </button>

        <button 
          mat-stroked-button 
          (click)="exportProject()"
          matTooltip="Download your poster">
          <mat-icon>download</mat-icon>
          <span>Export</span>
        </button>

        <button 
          mat-flat-button 
          color="primary"
          (click)="saveProject()"
          matTooltip="Save your progress">
          <mat-icon>save</mat-icon>
          <span>Save</span>
        </button>
      </div>
    </div>
  </mat-toolbar>

  <!-- Main Content -->
  <div class="main-content flex-1 flex min-h-0">
    <!-- Canvas Workspace -->
    <app-canvas-workspace class="flex-1 rounded-lg shadow-md"></app-canvas-workspace>

    <!-- Page Sidebar -->
    <app-page-sidebar class="rounded-lg shadow-md"></app-page-sidebar>
  </div>

  <!-- Floating Action Bar -->
  <app-floating-action-bar
    (addClick)="showAddElementPanel = true"
    (resizeClick)="showResizePanel = true"
    (themeClick)="showThemePanel = true"
    (backgroundColorClick)="showColorPickerPanel = true"
    (animateClick)="showAnimationPanel = true"
    (layersClick)="showLayersPanel = true"
    (quickReplaceClick)="onQuickReplace()">
  </app-floating-action-bar>

  <!-- Overlay for panels -->
  <div 
    class="panel-overlay fixed inset-0 bg-black bg-opacity-25 z-40"
    *ngIf="hasAnyPanelOpen"
    (click)="closeAllPanels()">
  </div>

  <!-- Panels -->
  <app-add-element-panel
    *ngIf="showAddElementPanel"
    [isOpen]="showAddElementPanel"
    (closePanel)="showAddElementPanel = false"
    (elementAdded)="onElementAdded($event)">
  </app-add-element-panel>

  <app-resize-panel
    *ngIf="showResizePanel"
    [isOpen]="showResizePanel"
    (closePanel)="showResizePanel = false"
    (resizeCanvas)="onResizeCanvas($event)">
  </app-resize-panel>

  <app-color-picker-panel
    *ngIf="showColorPickerPanel"
    [isOpen]="showColorPickerPanel"
    (closePanel)="showColorPickerPanel = false"
    (colorSelected)="onColorSelected($event)">
  </app-color-picker-panel>

  <app-theme-panel
    *ngIf="showThemePanel"
    [isOpen]="showThemePanel"
    (closePanel)="showThemePanel = false"
    (themeSelected)="onThemeSelected($event)">
  </app-theme-panel>

  <app-animation-panel
    *ngIf="showAnimationPanel"
    [isOpen]="showAnimationPanel"
    (closePanel)="showAnimationPanel = false"
    (animationSelected)="onAnimationSelected($event)">
  </app-animation-panel>

  <app-layers-panel
    *ngIf="showLayersPanel"
    [isOpen]="showLayersPanel"
    (closePanel)="showLayersPanel = false"
    (layerSelected)="onLayerSelected($event)"
    (layerVisibilityChanged)="onLayerVisibilityChanged($event)"
    (layerLockChanged)="onLayerLockChanged($event)"
    (layerOpacityChanged)="onLayerOpacityChanged($event)"
    (layerOrderChanged)="onLayerOrderChanged($event)">
  </app-layers-panel>
</div>